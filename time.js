!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("time",[],e):"object"==typeof exports?exports.time=e():(t.lazer=t.lazer||{},t.lazer.time=e())}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}({0:function(t,e,i){"use strict";"create index";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.MasterClock=e.Clock=void 0;var r=i(825),o=n(r),u=i(826),a=n(u);e.Clock=o["default"],e.MasterClock=a["default"]},156:function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=i(157),a=n(u),s=function(){function t(e){var i=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];r(this,t),this.root=e,this.forceSetTimeOut=i,i||(this.forceSetTimeOut=!this.normalizeRaf()),this._running=!1,this._timeOutID=null,this._callback=a["default"]}return o(t,[{key:"start",value:function(t){var e=this;this._running||(this._running=!0,this._callback=t,this.usingSetTimeout?this._timeOutID=this.root.setTimeout(function(t){return e.updateSetTimeout(Date.now())},0):this._timeOutID=this.root.requestAnimationFrame(function(t){return e.updateRAF(t)}))}},{key:"updateRAF",value:function(t){var e=this;this._callback(t),this._timeOutID=this.root.requestAnimationFrame(function(t){return e.updateRAF(t)})}},{key:"updateSetTimeout",value:function(t){var e=this;this._timeOutID=this.root.setTimeout(function(t){return e.updateSetTimeout(Date.now())},0)}},{key:"stop",value:function(){this._running&&(this.usingSetTimeout?this.root.clearTimeout(this._timeOutID):this.root.cancelAnimationFrame(this._timeOutID),this._running=!1)}},{key:"normalizeRaf",value:function(){if(this.root.requestAnimationFrame)return!0;for(var t=["ms","moz","webkit","o"],e=0;e<t.length;e++){var i=t[e];return this.root.requestAnimationFrame=this.root[i]+"RequestAnimationFrame",this.root.cancelAnimationFrame=this.root[i]+"CancelAnimationFrame",!0}return!1}},{key:"usingSetTimeout",get:function(){return this.forceSetTimeOut}},{key:"usingRAF",get:function(){return!this.forceSetTimeOut}},{key:"isRunning",get:function(){return this._running},set:function(t){t?this.start():this.stop()}}]),t}();e["default"]=s},157:function(t,e){"use strict";function i(){}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=i},825:function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=function(){function t(e){var n=arguments.length<=1||void 0===arguments[1]?0:arguments[1];i(this,t),this.master=e,this.tickSize=n,this.total=0,this.time=0,this.scale=1,this.callback=null,this.events=new Set}return n(t,[{key:"step",value:function(t){if(this.total+=t,this.total>=this.tickSize*this.scale){var e=this.total%(this.tickSize*this.scale);this.time++,this.total=e}}}]),t}();e["default"]=r},826:function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=i(156),a=n(u),s=i(825),c=n(s),l=function(){function t(){r(this,t),this.raf=new a["default"](window,!1),this.getTime=Date.now,window.performance&&(window.performance.now?this.getTime=function(){return window.performance.now()}:window.performance.webkitNow&&(this.getTime=function(){return window.performance.webkitNow()})),this.time=0,this.prevTime=0,this.elapsed=0,this._startTime=0,this.callback=null,this.clocks=new Set}return o(t,[{key:"init",value:function(t){var e=this;this.time=this.getTime(),this._startTime=this.time,this.callback=t,this.raf.start(function(t){return e.step(t)})}},{key:"step",value:function(t){this.prevTime=this.time,this.time=t,this.elapsed=this.time-this.prevTime;var e=!0,i=!1,n=void 0;try{for(var r,o=this.clocks[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var u=r.value;u.step(this.elapsed)}}catch(a){i=!0,n=a}finally{try{!e&&o["return"]&&o["return"]()}finally{if(i)throw n}}return this.callback(),16}},{key:"add",value:function(){var t=arguments.length<=0||void 0===arguments[0]?0:arguments[0],e=new c["default"](this,t);return this.clocks.add(e),e}},{key:"remove",value:function(t){this.clocks["delete"](t)}},{key:"destroy",value:function(){}},{key:"totalElapsed",get:function(){return this.time-this._startTime}}]),t}();e["default"]=l}})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uPzVjYTYqKioqKioqKioqKioqKioqKioqIiwid2VicGFjazovLy90aW1lLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCAxYjZmNThhMTc3NDUwODBmMDAxYT83NzllKioqKioqKioqKioqKioqKioqKiIsIndlYnBhY2s6Ly8vLi9zcmMvdGltZS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZG9tL1JlcXVlc3RBbmltYXRpb25GcmFtZS5qcz81ZWM1KioiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N5c3RlbS9OT09QLmpzPzFjZmQqKioiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RpbWUvQ2xvY2suanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3RpbWUvTWFzdGVyQ2xvY2suanMiXSwibmFtZXMiOlsicm9vdCIsImZhY3RvcnkiLCJleHBvcnRzIiwibW9kdWxlIiwiZGVmaW5lIiwiYW1kIiwidGhpcyIsIm1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpbnN0YWxsZWRNb2R1bGVzIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiMCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJNYXN0ZXJDbG9jayIsIkNsb2NrIiwidW5kZWZpbmVkIiwiX0Nsb2NrIiwiX0Nsb2NrMiIsIl9NYXN0ZXJDbG9jayIsIl9NYXN0ZXJDbG9jazIiLCIxNTYiLCJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImxlbmd0aCIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJwcm90b3R5cGUiLCJfTk9PUCIsIl9OT09QMiIsIlJlcXVlc3RBbmltYXRpb25GcmFtZSIsImZvcmNlU2V0VGltZU91dCIsImFyZ3VtZW50cyIsIm5vcm1hbGl6ZVJhZiIsIl9ydW5uaW5nIiwiX3RpbWVPdXRJRCIsIl9jYWxsYmFjayIsImNhbGxiYWNrIiwiX3RoaXMiLCJ1c2luZ1NldFRpbWVvdXQiLCJzZXRUaW1lb3V0Iiwibm93IiwidXBkYXRlU2V0VGltZW91dCIsIkRhdGUiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJ1cGRhdGVSQUYiLCJfdGhpczIiLCJfdGhpczMiLCJjbGVhclRpbWVvdXQiLCJjYW5jZWxBbmltYXRpb25GcmFtZSIsIl9hcnIiLCJfaSIsInZlbmRvciIsImdldCIsInNldCIsInN0YXJ0Iiwic3RvcCIsIjE1NyIsIk5PT1AiLCI4MjUiLCJtYXN0ZXJDbG9jayIsInRpY2tTaXplIiwibWFzdGVyIiwidG90YWwiLCJ0aW1lIiwic2NhbGUiLCJldmVudHMiLCJTZXQiLCJlbGFwc2VkIiwicmVtYWluZGVyIiwiODI2IiwiX1JlcXVlc3RBbmltYXRpb25GcmFtZSIsIl9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUyIiwicmFmIiwid2luZG93IiwiZ2V0VGltZSIsInBlcmZvcm1hbmNlIiwid2Via2l0Tm93IiwicHJldlRpbWUiLCJfc3RhcnRUaW1lIiwiY2xvY2tzIiwic3RlcCIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24iLCJfZGlkSXRlcmF0b3JFcnJvciIsIl9pdGVyYXRvckVycm9yIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwiY2xvY2siLCJlcnIiLCJhZGQiXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEVBQUFDLEdBQ0EsZ0JBQUFDLFVBQUEsZ0JBQUFDLFFBQ0FBLE9BQUFELFFBQUFELElBQ0Esa0JBQUFHLGdCQUFBQyxJQUNBRCxPQUFB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LElBQUssTUFDTHZCLE1BQU8sV00xV0QsR0FBZDRELEdBQWM3QixVQUFBYixRQUFBLEdBQUFmLFNBQUE0QixVQUFBLEdBQUgsRUFBR0EsVUFBQSxHQUVYMkQsRUFBUSxHQUFBckYsY0FBVXZCLEtBQU04RSxFQUk1QixPQUZBOUUsTUFBS2lHLE9BQU9hLElBQUlGLEdBRVRBLEtOK1dFbkUsSUFBSyxTQUNMdkIsTUFBTyxTTTVXWjBGLEdBRUo1RyxLQUFLaUcsT0FBTGpHLFVBQW1CNEcsTU4rV1ZuRSxJQUFLLFVBQ0x2QixNQUFPLGVBRVB1QixJQUFLLGVBQ0w2QixJQUFLLFdNeldkLE1BQU90RSxNQUFLaUYsS0FBT2pGLEtBQUtnRyxlTitXaEI3RSxJQUdmdkIsY01uZW9CdUIiLCJmaWxlIjoidGltZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFwidGltZVwiLCBbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJ0aW1lXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcImxhemVyXCJdID0gcm9vdFtcImxhemVyXCJdIHx8IHt9LCByb290W1wibGF6ZXJcIl1bXCJ0aW1lXCJdID0gZmFjdG9yeSgpO1xufSkodGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uXG4gKiovIiwiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoXCJ0aW1lXCIsIFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcInRpbWVcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wibGF6ZXJcIl0gPSByb290W1wibGF6ZXJcIl0gfHwge30sIHJvb3RbXCJsYXplclwiXVtcInRpbWVcIl0gPSBmYWN0b3J5KCk7XG59KSh0aGlzLCBmdW5jdGlvbigpIHtcbnJldHVybiAvKioqKioqLyAoZnVuY3Rpb24obW9kdWxlcykgeyAvLyB3ZWJwYWNrQm9vdHN0cmFwXG4vKioqKioqLyBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4vKioqKioqLyBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4vKioqKioqLyBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4vKioqKioqLyBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbi8qKioqKiovIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4vKioqKioqLyBcdFx0XHRleHBvcnRzOiB7fSxcbi8qKioqKiovIFx0XHRcdGlkOiBtb2R1bGVJZCxcbi8qKioqKiovIFx0XHRcdGxvYWRlZDogZmFsc2Vcbi8qKioqKiovIFx0XHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbi8qKioqKiovIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuLyoqKioqKi8gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuLyoqKioqKi8gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbi8qKioqKiovIFx0fVxuLyoqKioqKi9cbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuLyoqKioqKi8gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcbi8qKioqKiovIH0pXG4vKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuLyoqKioqKi8gKHtcblxuLyoqKi8gMDpcbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0J2NyZWF0ZSBpbmRleCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLk1hc3RlckNsb2NrID0gZXhwb3J0cy5DbG9jayA9IHVuZGVmaW5lZDtcblx0XG5cdHZhciBfQ2xvY2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgyNSk7XG5cdFxuXHR2YXIgX0Nsb2NrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX0Nsb2NrKTtcblx0XG5cdHZhciBfTWFzdGVyQ2xvY2sgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgyNik7XG5cdFxuXHR2YXIgX01hc3RlckNsb2NrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX01hc3RlckNsb2NrKTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRleHBvcnRzLkNsb2NrID0gX0Nsb2NrMi5kZWZhdWx0O1xuXHRleHBvcnRzLk1hc3RlckNsb2NrID0gX01hc3RlckNsb2NrMi5kZWZhdWx0O1xuXG4vKioqLyB9LFxuXG4vKioqLyAxNTY6XG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdHZhciBfTk9PUCA9IF9fd2VicGFja19yZXF1aXJlX18oMTU3KTtcblx0XG5cdHZhciBfTk9PUDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9OT09QKTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXHRcblx0dmFyIFJlcXVlc3RBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIFJlcXVlc3RBbmltYXRpb25GcmFtZShyb290KSB7XG5cdCAgICAgICAgdmFyIGZvcmNlU2V0VGltZU91dCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzFdO1xuXHRcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmVxdWVzdEFuaW1hdGlvbkZyYW1lKTtcblx0XG5cdCAgICAgICAgdGhpcy5yb290ID0gcm9vdDtcblx0ICAgICAgICB0aGlzLmZvcmNlU2V0VGltZU91dCA9IGZvcmNlU2V0VGltZU91dDtcblx0XG5cdCAgICAgICAgLy8gIElmIHRoZXJlJ3Mgbm8gd2luZG93IG9iamVjdCBvciBSQUYgdGhlbiB3ZSBoYXZlIHRvIHVzZSBTVCBhbnl3YXlcblx0ICAgICAgICBpZiAoIWZvcmNlU2V0VGltZU91dCkge1xuXHQgICAgICAgICAgICB0aGlzLmZvcmNlU2V0VGltZU91dCA9ICF0aGlzLm5vcm1hbGl6ZVJhZigpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGhpcy5fcnVubmluZyA9IGZhbHNlO1xuXHQgICAgICAgIHRoaXMuX3RpbWVPdXRJRCA9IG51bGw7XG5cdCAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBfTk9PUDIuZGVmYXVsdDtcblx0ICAgIH1cblx0XG5cdCAgICAvLyAgVW5kZXIgU2V0VGltZW91dCB0aGUgY2FsbGJhY2sgbXVzdCByZXR1cm4gdGhlIG1zIHZhbHVlIG9mIHdoZW4gdG8gcnVuIHRoZSBuZXh0IHVwZGF0ZVxuXHRcblx0XG5cdCAgICBfY3JlYXRlQ2xhc3MoUmVxdWVzdEFuaW1hdGlvbkZyYW1lLCBbe1xuXHQgICAgICAgIGtleTogJ3N0YXJ0Jyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RhcnQoY2FsbGJhY2spIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0XG5cdCAgICAgICAgICAgIGlmICghdGhpcy5fcnVubmluZykge1xuXHQgICAgICAgICAgICAgICAgdGhpcy5fcnVubmluZyA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICB0aGlzLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xuXHRcblx0ICAgICAgICAgICAgICAgIGlmICh0aGlzLnVzaW5nU2V0VGltZW91dCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVPdXRJRCA9IHRoaXMucm9vdC5zZXRUaW1lb3V0KGZ1bmN0aW9uIChub3cpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnVwZGF0ZVNldFRpbWVvdXQoRGF0ZS5ub3coKSk7XG5cdCAgICAgICAgICAgICAgICAgICAgfSwgMCk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVPdXRJRCA9IHRoaXMucm9vdC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKG5vdykge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMudXBkYXRlUkFGKG5vdyk7XG5cdCAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAndXBkYXRlUkFGJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlUkFGKG5vdykge1xuXHQgICAgICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblx0XG5cdCAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrKG5vdyk7XG5cdFxuXHQgICAgICAgICAgICB0aGlzLl90aW1lT3V0SUQgPSB0aGlzLnJvb3QucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uIChub3cpIHtcblx0ICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIudXBkYXRlUkFGKG5vdyk7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICd1cGRhdGVTZXRUaW1lb3V0Jyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlU2V0VGltZW91dChub3cpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICB0aGlzLl90aW1lT3V0SUQgPSB0aGlzLnJvb3Quc2V0VGltZW91dChmdW5jdGlvbiAobm93KSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzLnVwZGF0ZVNldFRpbWVvdXQoRGF0ZS5ub3coKSk7XG5cdCAgICAgICAgICAgIH0sIDApO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdzdG9wJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RvcCgpIHtcblx0XG5cdCAgICAgICAgICAgIGlmICh0aGlzLl9ydW5uaW5nKSB7XG5cdCAgICAgICAgICAgICAgICBpZiAodGhpcy51c2luZ1NldFRpbWVvdXQpIHtcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLnJvb3QuY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVPdXRJRCk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMucm9vdC5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLl90aW1lT3V0SUQpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgICAgIHRoaXMuX3J1bm5pbmcgPSBmYWxzZTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdub3JtYWxpemVSYWYnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBub3JtYWxpemVSYWYoKSB7XG5cdFxuXHQgICAgICAgICAgICBpZiAodGhpcy5yb290LnJlcXVlc3RBbmltYXRpb25GcmFtZSkge1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgX2FyciA9IFsnbXMnLCAnbW96JywgJ3dlYmtpdCcsICdvJ107XG5cdFxuXHQgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IF9hcnIubGVuZ3RoOyBfaSsrKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdmFyIHZlbmRvciA9IF9hcnJbX2ldO1xuXHQgICAgICAgICAgICAgICAgICAgIGlmICh0cnVlKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucm9vdC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSB0aGlzLnJvb3RbdmVuZG9yXSArICdSZXF1ZXN0QW5pbWF0aW9uRnJhbWUnO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJvb3QuY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSB0aGlzLnJvb3RbdmVuZG9yXSArICdDYW5jZWxBbmltYXRpb25GcmFtZSc7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICd1c2luZ1NldFRpbWVvdXQnLFxuXHQgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm9yY2VTZXRUaW1lT3V0O1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICd1c2luZ1JBRicsXG5cdCAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gIXRoaXMuZm9yY2VTZXRUaW1lT3V0O1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdpc1J1bm5pbmcnLFxuXHQgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3J1bm5pbmc7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuXHRcblx0ICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG5cdCAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0KCk7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICB0aGlzLnN0b3AoKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gUmVxdWVzdEFuaW1hdGlvbkZyYW1lO1xuXHR9KCk7XG5cdFxuXHRleHBvcnRzLmRlZmF1bHQgPSBSZXF1ZXN0QW5pbWF0aW9uRnJhbWU7XG5cbi8qKiovIH0sXG5cbi8qKiovIDE1Nzpcbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0ZXhwb3J0cy5kZWZhdWx0ID0gTk9PUDtcblx0Ly8gSW4gYWxsIG1ham9yIGJyb3dzZXJzLCByZXBsYWNpbmcgbm9uLXNwZWNpZmllZCBmdW5jdGlvbnMgd2l0aCBOT09Qc1xuXHQvLyBzZWVtcyB0byBiZSBhcyBmYXN0IG9yIHNsaWdodGx5IGZhc3RlciB0aGFuIHVzaW5nIGNvbmRpdGlvbnMgdG8gb25seVxuXHQvLyBjYWxsIHRoZSBmdW5jdGlvbnMgaWYgdGhleSBhcmUgc3BlY2lmaWVkLiBUaGlzIGlzIHByb2JhYmx5IGR1ZSB0byBlbXB0eVxuXHQvLyBmdW5jdGlvbnMgYmVpbmcgb3B0aW1pemVkIGF3YXkuIGh0dHA6Ly9qc3BlcmYuY29tL25vb3AtdnMtY29uZGl0aW9uXG5cdFxuXHRmdW5jdGlvbiBOT09QKCkge1xuXHRcblx0ICAgIC8vICBUaGF0J3MgcmlnaHQsIHRoZXJlJ3Mgbm90aGluZyBoZXJlLlxuXHRcblx0fVxuXG4vKioqLyB9LFxuXG4vKioqLyA4MjU6XG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHR2YXIgQ2xvY2sgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgZnVuY3Rpb24gQ2xvY2sobWFzdGVyQ2xvY2spIHtcblx0ICAgICAgICAgICAgICAgIHZhciB0aWNrU2l6ZSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IDAgOiBhcmd1bWVudHNbMV07XG5cdFxuXHQgICAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENsb2NrKTtcblx0XG5cdCAgICAgICAgICAgICAgICB0aGlzLm1hc3RlciA9IG1hc3RlckNsb2NrO1xuXHRcblx0ICAgICAgICAgICAgICAgIHRoaXMudGlja1NpemUgPSB0aWNrU2l6ZTtcblx0XG5cdCAgICAgICAgICAgICAgICB0aGlzLnRvdGFsID0gMDtcblx0XG5cdCAgICAgICAgICAgICAgICB0aGlzLnRpbWUgPSAwO1xuXHRcblx0ICAgICAgICAgICAgICAgIHRoaXMuc2NhbGUgPSAxO1xuXHRcblx0ICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2sgPSBudWxsO1xuXHRcblx0ICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRzID0gbmV3IFNldCgpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgX2NyZWF0ZUNsYXNzKENsb2NrLCBbe1xuXHQgICAgICAgICAgICAgICAga2V5OiBcInN0ZXBcIixcblx0ICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdGVwKGVsYXBzZWQpIHtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vICBUaGlzIGlzIGNhbGxlZCBldmVyeSB0aW1lIHRoZSBNYXN0ZXJDbG9jayB1cGRhdGVzXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vICB0aGUgJ2VsYXBzZWQnIHZhbHVlIGJlaW5nIHRoZSBhbW91bnQgb2YgbWljcm9zZWNvbmRzIHRoYXQgcGFzc2VkXG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvdGFsICs9IGVsYXBzZWQ7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50b3RhbCA+PSB0aGlzLnRpY2tTaXplICogdGhpcy5zY2FsZSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICBTdG9yZSB0aGUgcmVtYWluZGVyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbWFpbmRlciA9IHRoaXMudG90YWwgJSAodGhpcy50aWNrU2l6ZSAqIHRoaXMuc2NhbGUpO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWUrKztcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5jYWxsYmFjaygpO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRvdGFsID0gcmVtYWluZGVyO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgfV0pO1xuXHRcblx0ICAgICAgICByZXR1cm4gQ2xvY2s7XG5cdH0oKTtcblx0XG5cdGV4cG9ydHMuZGVmYXVsdCA9IENsb2NrO1xuXG4vKioqLyB9LFxuXG4vKioqLyA4MjY6XG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgICAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cdFxuXHR2YXIgX1JlcXVlc3RBbmltYXRpb25GcmFtZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTU2KTtcblx0XG5cdHZhciBfUmVxdWVzdEFuaW1hdGlvbkZyYW1lMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1JlcXVlc3RBbmltYXRpb25GcmFtZSk7XG5cdFxuXHR2YXIgX0Nsb2NrID0gX193ZWJwYWNrX3JlcXVpcmVfXyg4MjUpO1xuXHRcblx0dmFyIF9DbG9jazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9DbG9jayk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdC8vICBUaGlzIGNhbiBpbXBsZW1lbnQgUkFGIGl0c2VsZiwgc28gaXQgY2FuIGJlIHRoZSBoZWFydCBvZiB0aGUgR2FtZS5cblx0Ly8gIFRoZW4gR2FtZUNsb2NrIG9iamVjdHMgd2lsbCB1c2UgdGhpcyBkYXRhIHRvIHJ1biBmcm9tLCBpbmNsdWRpbmcgdGhlaXJcblx0Ly8gIG93biBzdGVwcGluZyByYXRlLCBzbG93IG1vdGlvbiwgZXRjLiBFYWNoIFN0YXRlIGNhbiBoYXZlIGl0cyBvd24gR2FtZUNsb2NrIGluc3RhbmNlLFxuXHQvLyAgdXBkYXRpbmcgYXQgd2hhdGV2ZXIgcmF0ZSBpdCByZXF1aXJlcy5cblx0XG5cdC8vICBXaGF0IHdlJ3ZlIGdvdCBoZXJlIGlzIGFuIG92ZXJsYXAgb2YgcmVzcG9uc2liaWxpdGllcyBiZXR3ZWVuIENsb2NrIGFuZCBNYWluTG9vcC5cblx0Ly8gIFRoZXkgbmVlZCBidW5kbGluZyB0b2dldGhlci5cblx0XG5cdC8vICBUaGVyZSBzaG91bGQgYmUgb25seSBvbmUgTWFzdGVyQ2xvY2sgcGVyIEdhbWUgaW5zdGFuY2Vcblx0XG5cdHZhciBNYXN0ZXJDbG9jayA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBmdW5jdGlvbiBNYXN0ZXJDbG9jaygpIHtcblx0ICAgICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNYXN0ZXJDbG9jayk7XG5cdFxuXHQgICAgICAgICAgICAgICAgdGhpcy5yYWYgPSBuZXcgX1JlcXVlc3RBbmltYXRpb25GcmFtZTIuZGVmYXVsdCh3aW5kb3csIGZhbHNlKTtcblx0XG5cdCAgICAgICAgICAgICAgICAvLyAgVGhpcyBuZWVkcyBub3JtYWxpc2luZyB3aXRoIHBlcmYgbm93IGluIHRoZSBzdGVwIGxvb3Bcblx0ICAgICAgICAgICAgICAgIHRoaXMuZ2V0VGltZSA9IERhdGUubm93O1xuXHRcblx0ICAgICAgICAgICAgICAgIGlmICh3aW5kb3cucGVyZm9ybWFuY2UpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5wZXJmb3JtYW5jZS5ub3cpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldFRpbWUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAod2luZG93LnBlcmZvcm1hbmNlLndlYmtpdE5vdykge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0VGltZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3aW5kb3cucGVyZm9ybWFuY2Uud2Via2l0Tm93KCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgICAgIC8qKlxyXG5cdCAgICAgICAgICAgICAgICAqIFRoZSBgcGVyZm9ybWFuY2Uubm93KClgIHZhbHVlIHdoZW4gdGhlIHRpbWUgd2FzIGxhc3QgdXBkYXRlZC5cclxuXHQgICAgICAgICAgICAgICAgKiBAcHJvcGVydHkge2Zsb2F0fSB0aW1lXHJcblx0ICAgICAgICAgICAgICAgICogQHByb3RlY3RlZFxyXG5cdCAgICAgICAgICAgICAgICAqL1xuXHQgICAgICAgICAgICAgICAgdGhpcy50aW1lID0gMDtcblx0XG5cdCAgICAgICAgICAgICAgICAvKipcclxuXHQgICAgICAgICAgICAgICAgKiBUaGUgYG5vd2Agd2hlbiB0aGUgcHJldmlvdXMgdXBkYXRlIG9jY3VycmVkLlxyXG5cdCAgICAgICAgICAgICAgICAqIEBwcm9wZXJ0eSB7ZmxvYXR9IHByZXZUaW1lXHJcblx0ICAgICAgICAgICAgICAgICogQHByb3RlY3RlZFxyXG5cdCAgICAgICAgICAgICAgICAqL1xuXHQgICAgICAgICAgICAgICAgdGhpcy5wcmV2VGltZSA9IDA7XG5cdFxuXHQgICAgICAgICAgICAgICAgLyoqXHJcblx0ICAgICAgICAgICAgICAgICogRWxhcHNlZCB0aW1lIHNpbmNlIHRoZSBsYXN0IHRpbWUgdXBkYXRlLCBpbiBtaWxsaXNlY29uZHMsIGJhc2VkIG9uIGBub3dgLlxyXG5cdCAgICAgICAgICAgICAgICAqXHJcblx0ICAgICAgICAgICAgICAgICogVGhpcyB2YWx1ZSBfbWF5XyBpbmNsdWRlIHRpbWUgdGhhdCB0aGUgZ2FtZSBpcyBwYXVzZWQvaW5hY3RpdmUuXHJcblx0ICAgICAgICAgICAgICAgICpcclxuXHQgICAgICAgICAgICAgICAgKiBfTm90ZTpfIFRoaXMgaXMgdXBkYXRlZCBvbmx5IG9uY2UgcGVyIGdhbWUgbG9vcCAtIGV2ZW4gaWYgbXVsdGlwbGUgbG9naWMgdXBkYXRlIHN0ZXBzIGFyZSBkb25lLlxyXG5cdCAgICAgICAgICAgICAgICAqIFVzZSB7QGxpbmsgTGF6ZXIuVGltZXIjcGh5c2ljc1RpbWUgcGh5c2ljc1RpbWV9IGFzIGEgYmFzaXMgb2YgZ2FtZS9sb2dpYyBjYWxjdWxhdGlvbnMgaW5zdGVhZC5cclxuXHQgICAgICAgICAgICAgICAgKlxyXG5cdCAgICAgICAgICAgICAgICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBlbGFwc2VkXHJcblx0ICAgICAgICAgICAgICAgICogQHNlZSBMYXplci5UaW1lLnRpbWVcclxuXHQgICAgICAgICAgICAgICAgKiBAcHJvdGVjdGVkXHJcblx0ICAgICAgICAgICAgICAgICovXG5cdCAgICAgICAgICAgICAgICB0aGlzLmVsYXBzZWQgPSAwO1xuXHRcblx0ICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0VGltZSA9IDA7XG5cdFxuXHQgICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFjayA9IG51bGw7XG5cdFxuXHQgICAgICAgICAgICAgICAgdGhpcy5jbG9ja3MgPSBuZXcgU2V0KCk7XG5cdCAgICAgICAgfVxuXHRcblx0ICAgICAgICBfY3JlYXRlQ2xhc3MoTWFzdGVyQ2xvY2ssIFt7XG5cdCAgICAgICAgICAgICAgICBrZXk6ICdpbml0Jyxcblx0ICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KGNhbGxiYWNrKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWUgPSB0aGlzLmdldFRpbWUoKTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXJ0VGltZSA9IHRoaXMudGltZTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vICBUaGlzIHN0YXJ0cyBSQUYgZ29pbmcgYXV0b21hdGljYWxseVxuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJhZi5zdGFydChmdW5jdGlvbiAobm93KSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnN0ZXAobm93KTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gIHRoaXMucmFmIHByb3ZpZGVzIHBlcmZvcm1hbmNlLm5vdyBhcyBhbiBhcmd1bWVudCAob3IgRGF0ZS5ub3cgdW5kZXIgU2V0VGltZW91dClcblx0XG5cdCAgICAgICAgfSwge1xuXHQgICAgICAgICAgICAgICAga2V5OiAnc3RlcCcsXG5cdCAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RlcChub3cpIHtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJldlRpbWUgPSB0aGlzLnRpbWU7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRpbWUgPSBub3c7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVsYXBzZWQgPSB0aGlzLnRpbWUgLSB0aGlzLnByZXZUaW1lO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IgPSBmYWxzZTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSB0aGlzLmNsb2Nrc1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSAoX3N0ZXAgPSBfaXRlcmF0b3IubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWUpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbG9jayA9IF9zdGVwLnZhbHVlO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb2NrLnN0ZXAodGhpcy5lbGFwc2VkKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IGVycjtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uICYmIF9pdGVyYXRvci5yZXR1cm4pIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yLnJldHVybigpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrKCk7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAvLyAgRm9yIFNldFRpbWVvdXQgUkFGXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxNjtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICB9LCB7XG5cdCAgICAgICAgICAgICAgICBrZXk6ICdhZGQnLFxuXHQgICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZCgpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRpY2tTaXplID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8gMCA6IGFyZ3VtZW50c1swXTtcblx0XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2xvY2sgPSBuZXcgX0Nsb2NrMi5kZWZhdWx0KHRoaXMsIHRpY2tTaXplKTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvY2tzLmFkZChjbG9jayk7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2xvY2s7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgfSwge1xuXHQgICAgICAgICAgICAgICAga2V5OiAncmVtb3ZlJyxcblx0ICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmUoY2xvY2spIHtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvY2tzLmRlbGV0ZShjbG9jayk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgfSwge1xuXHQgICAgICAgICAgICAgICAga2V5OiAnZGVzdHJveScsXG5cdCAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHt9XG5cdCAgICAgICAgfSwge1xuXHQgICAgICAgICAgICAgICAga2V5OiAndG90YWxFbGFwc2VkJyxcblx0ICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGltZSAtIHRoaXMuX3N0YXJ0VGltZTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICB9XSk7XG5cdFxuXHQgICAgICAgIHJldHVybiBNYXN0ZXJDbG9jaztcblx0fSgpO1xuXHRcblx0ZXhwb3J0cy5kZWZhdWx0ID0gTWFzdGVyQ2xvY2s7XG5cbi8qKiovIH1cblxuLyoqKioqKi8gfSlcbn0pO1xuO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHRpbWUuanNcbiAqKi8iLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHdlYnBhY2svYm9vdHN0cmFwIDFiNmY1OGExNzc0NTA4MGYwMDFhXG4gKiovIiwiJ2NyZWF0ZSBpbmRleCc7XHJcblxyXG5pbXBvcnQgQ2xvY2sgZnJvbSAnLi9DbG9jay5qcyc7XHJcbmltcG9ydCBNYXN0ZXJDbG9jayBmcm9tICcuL01hc3RlckNsb2NrLmpzJztcclxuXHJcbmV4cG9ydCB7XHJcbiAgICBDbG9jayxcclxuICAgIE1hc3RlckNsb2NrXHJcbn07XHJcblxyXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy90aW1lL2luZGV4LmpzXG4gKiovIiwiaW1wb3J0IE5PT1AgZnJvbSAnLi4vc3lzdGVtL05PT1AuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVxdWVzdEFuaW1hdGlvbkZyYW1lIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciAocm9vdCwgZm9yY2VTZXRUaW1lT3V0ID0gZmFsc2UpIHtcclxuXHJcbiAgICAgICAgdGhpcy5yb290ID0gcm9vdDtcclxuICAgICAgICB0aGlzLmZvcmNlU2V0VGltZU91dCA9IGZvcmNlU2V0VGltZU91dDtcclxuXHJcbiAgICAgICAgLy8gIElmIHRoZXJlJ3Mgbm8gd2luZG93IG9iamVjdCBvciBSQUYgdGhlbiB3ZSBoYXZlIHRvIHVzZSBTVCBhbnl3YXlcclxuICAgICAgICBpZiAoIWZvcmNlU2V0VGltZU91dClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuZm9yY2VTZXRUaW1lT3V0ID0gIXRoaXMubm9ybWFsaXplUmFmKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9ydW5uaW5nID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fdGltZU91dElEID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9jYWxsYmFjayA9IE5PT1A7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIC8vICBVbmRlciBTZXRUaW1lb3V0IHRoZSBjYWxsYmFjayBtdXN0IHJldHVybiB0aGUgbXMgdmFsdWUgb2Ygd2hlbiB0byBydW4gdGhlIG5leHQgdXBkYXRlXHJcbiAgICBzdGFydCAoY2FsbGJhY2spIHtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLl9ydW5uaW5nKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5fcnVubmluZyA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrID0gY2FsbGJhY2s7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy51c2luZ1NldFRpbWVvdXQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVPdXRJRCA9IHRoaXMucm9vdC5zZXRUaW1lb3V0KG5vdyA9PiB0aGlzLnVwZGF0ZVNldFRpbWVvdXQoRGF0ZS5ub3coKSksIDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fdGltZU91dElEID0gdGhpcy5yb290LnJlcXVlc3RBbmltYXRpb25GcmFtZShub3cgPT4gdGhpcy51cGRhdGVSQUYobm93KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZVJBRiAobm93KSB7XHJcblxyXG4gICAgICAgIHRoaXMuX2NhbGxiYWNrKG5vdyk7XHJcblxyXG4gICAgICAgIHRoaXMuX3RpbWVPdXRJRCA9IHRoaXMucm9vdC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUobm93ID0+IHRoaXMudXBkYXRlUkFGKG5vdykpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVTZXRUaW1lb3V0IChub3cpIHtcclxuXHJcbiAgICAgICAgdGhpcy5fdGltZU91dElEID0gdGhpcy5yb290LnNldFRpbWVvdXQobm93ID0+IHRoaXMudXBkYXRlU2V0VGltZW91dChEYXRlLm5vdygpKSwgMCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHN0b3AgKCkge1xyXG5cclxuICAgICAgICBpZiAodGhpcy5fcnVubmluZylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnVzaW5nU2V0VGltZW91dClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yb290LmNsZWFyVGltZW91dCh0aGlzLl90aW1lT3V0SUQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yb290LmNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuX3RpbWVPdXRJRCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3J1bm5pbmcgPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG5vcm1hbGl6ZVJhZiAoKSB7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnJvb3QucmVxdWVzdEFuaW1hdGlvbkZyYW1lKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHZlbmRvciBvZiBbJ21zJywgJ21veicsICd3ZWJraXQnLCAnbyddKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yb290W3ZlbmRvcl0gKyAnUmVxdWVzdEFuaW1hdGlvbkZyYW1lJylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJvb3QucmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gdGhpcy5yb290W3ZlbmRvcl0gKyAnUmVxdWVzdEFuaW1hdGlvbkZyYW1lJztcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJvb3QuY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSB0aGlzLnJvb3RbdmVuZG9yXSArICdDYW5jZWxBbmltYXRpb25GcmFtZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHVzaW5nU2V0VGltZW91dCAoKSB7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmZvcmNlU2V0VGltZU91dDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHVzaW5nUkFGICgpIHtcclxuXHJcbiAgICAgICAgcmV0dXJuICF0aGlzLmZvcmNlU2V0VGltZU91dDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGlzUnVubmluZyAoKSB7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLl9ydW5uaW5nO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZXQgaXNSdW5uaW5nICh2YWx1ZSkge1xyXG5cclxuICAgICAgICBpZiAodmFsdWUpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLnN0YXJ0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG59XHJcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2RvbS9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUuanNcbiAqKi8iLCIvLyBJbiBhbGwgbWFqb3IgYnJvd3NlcnMsIHJlcGxhY2luZyBub24tc3BlY2lmaWVkIGZ1bmN0aW9ucyB3aXRoIE5PT1BzXHJcbi8vIHNlZW1zIHRvIGJlIGFzIGZhc3Qgb3Igc2xpZ2h0bHkgZmFzdGVyIHRoYW4gdXNpbmcgY29uZGl0aW9ucyB0byBvbmx5XHJcbi8vIGNhbGwgdGhlIGZ1bmN0aW9ucyBpZiB0aGV5IGFyZSBzcGVjaWZpZWQuIFRoaXMgaXMgcHJvYmFibHkgZHVlIHRvIGVtcHR5XHJcbi8vIGZ1bmN0aW9ucyBiZWluZyBvcHRpbWl6ZWQgYXdheS4gaHR0cDovL2pzcGVyZi5jb20vbm9vcC12cy1jb25kaXRpb25cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIE5PT1AgKCkge1xyXG5cclxuICAgIC8vICBUaGF0J3MgcmlnaHQsIHRoZXJlJ3Mgbm90aGluZyBoZXJlLlxyXG4gICAgXHJcbn1cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9zeXN0ZW0vTk9PUC5qc1xuICoqLyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENsb2NrIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciAobWFzdGVyQ2xvY2ssIHRpY2tTaXplID0gMCkge1xyXG5cclxuICAgICAgICB0aGlzLm1hc3RlciA9IG1hc3RlckNsb2NrO1xyXG5cclxuICAgICAgICB0aGlzLnRpY2tTaXplID0gdGlja1NpemU7XHJcblxyXG4gICAgICAgIHRoaXMudG90YWwgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLnRpbWUgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLnNjYWxlID0gMTtcclxuXHJcbiAgICAgICAgdGhpcy5jYWxsYmFjayA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuZXZlbnRzID0gbmV3IFNldCgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzdGVwIChlbGFwc2VkKSB7XHJcblxyXG4gICAgICAgIC8vICBUaGlzIGlzIGNhbGxlZCBldmVyeSB0aW1lIHRoZSBNYXN0ZXJDbG9jayB1cGRhdGVzXHJcbiAgICAgICAgLy8gIHRoZSAnZWxhcHNlZCcgdmFsdWUgYmVpbmcgdGhlIGFtb3VudCBvZiBtaWNyb3NlY29uZHMgdGhhdCBwYXNzZWRcclxuXHJcbiAgICAgICAgdGhpcy50b3RhbCArPSBlbGFwc2VkO1xyXG5cclxuICAgICAgICBpZiAodGhpcy50b3RhbCA+PSAodGhpcy50aWNrU2l6ZSAqIHRoaXMuc2NhbGUpKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgLy8gIFN0b3JlIHRoZSByZW1haW5kZXJcclxuICAgICAgICAgICAgY29uc3QgcmVtYWluZGVyID0gdGhpcy50b3RhbCAlICh0aGlzLnRpY2tTaXplICogdGhpcy5zY2FsZSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnRpbWUrKztcclxuXHJcbiAgICAgICAgICAgIC8vIHRoaXMuY2FsbGJhY2soKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMudG90YWwgPSByZW1haW5kZXI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbn1cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy90aW1lL0Nsb2NrLmpzXG4gKiovIiwiaW1wb3J0IFJlcXVlc3RBbmltYXRpb25GcmFtZSBmcm9tICcuLi9kb20vUmVxdWVzdEFuaW1hdGlvbkZyYW1lLmpzJztcclxuaW1wb3J0IENsb2NrIGZyb20gJy4vQ2xvY2suanMnO1xyXG5cclxuLy8gIFRoaXMgY2FuIGltcGxlbWVudCBSQUYgaXRzZWxmLCBzbyBpdCBjYW4gYmUgdGhlIGhlYXJ0IG9mIHRoZSBHYW1lLlxyXG4vLyAgVGhlbiBHYW1lQ2xvY2sgb2JqZWN0cyB3aWxsIHVzZSB0aGlzIGRhdGEgdG8gcnVuIGZyb20sIGluY2x1ZGluZyB0aGVpclxyXG4vLyAgb3duIHN0ZXBwaW5nIHJhdGUsIHNsb3cgbW90aW9uLCBldGMuIEVhY2ggU3RhdGUgY2FuIGhhdmUgaXRzIG93biBHYW1lQ2xvY2sgaW5zdGFuY2UsXHJcbi8vICB1cGRhdGluZyBhdCB3aGF0ZXZlciByYXRlIGl0IHJlcXVpcmVzLlxyXG5cclxuLy8gIFdoYXQgd2UndmUgZ290IGhlcmUgaXMgYW4gb3ZlcmxhcCBvZiByZXNwb25zaWJpbGl0aWVzIGJldHdlZW4gQ2xvY2sgYW5kIE1haW5Mb29wLlxyXG4vLyAgVGhleSBuZWVkIGJ1bmRsaW5nIHRvZ2V0aGVyLlxyXG5cclxuLy8gIFRoZXJlIHNob3VsZCBiZSBvbmx5IG9uZSBNYXN0ZXJDbG9jayBwZXIgR2FtZSBpbnN0YW5jZVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWFzdGVyQ2xvY2sge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5yYWYgPSBuZXcgUmVxdWVzdEFuaW1hdGlvbkZyYW1lKHdpbmRvdywgZmFsc2UpO1xyXG5cclxuICAgICAgICAvLyAgVGhpcyBuZWVkcyBub3JtYWxpc2luZyB3aXRoIHBlcmYgbm93IGluIHRoZSBzdGVwIGxvb3BcclxuICAgICAgICB0aGlzLmdldFRpbWUgPSBEYXRlLm5vdztcclxuXHJcbiAgICAgICAgaWYgKHdpbmRvdy5wZXJmb3JtYW5jZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmICh3aW5kb3cucGVyZm9ybWFuY2Uubm93KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFRpbWUgPSAoKSA9PiB7IHJldHVybiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCkgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh3aW5kb3cucGVyZm9ybWFuY2Uud2Via2l0Tm93KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFRpbWUgPSAoKSA9PiB7IHJldHVybiB3aW5kb3cucGVyZm9ybWFuY2Uud2Via2l0Tm93KCkgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgKiBUaGUgYHBlcmZvcm1hbmNlLm5vdygpYCB2YWx1ZSB3aGVuIHRoZSB0aW1lIHdhcyBsYXN0IHVwZGF0ZWQuXHJcbiAgICAgICAgKiBAcHJvcGVydHkge2Zsb2F0fSB0aW1lXHJcbiAgICAgICAgKiBAcHJvdGVjdGVkXHJcbiAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnRpbWUgPSAwO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAqIFRoZSBgbm93YCB3aGVuIHRoZSBwcmV2aW91cyB1cGRhdGUgb2NjdXJyZWQuXHJcbiAgICAgICAgKiBAcHJvcGVydHkge2Zsb2F0fSBwcmV2VGltZVxyXG4gICAgICAgICogQHByb3RlY3RlZFxyXG4gICAgICAgICovXHJcbiAgICAgICAgdGhpcy5wcmV2VGltZSA9IDA7XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICogRWxhcHNlZCB0aW1lIHNpbmNlIHRoZSBsYXN0IHRpbWUgdXBkYXRlLCBpbiBtaWxsaXNlY29uZHMsIGJhc2VkIG9uIGBub3dgLlxyXG4gICAgICAgICpcclxuICAgICAgICAqIFRoaXMgdmFsdWUgX21heV8gaW5jbHVkZSB0aW1lIHRoYXQgdGhlIGdhbWUgaXMgcGF1c2VkL2luYWN0aXZlLlxyXG4gICAgICAgICpcclxuICAgICAgICAqIF9Ob3RlOl8gVGhpcyBpcyB1cGRhdGVkIG9ubHkgb25jZSBwZXIgZ2FtZSBsb29wIC0gZXZlbiBpZiBtdWx0aXBsZSBsb2dpYyB1cGRhdGUgc3RlcHMgYXJlIGRvbmUuXHJcbiAgICAgICAgKiBVc2Uge0BsaW5rIExhemVyLlRpbWVyI3BoeXNpY3NUaW1lIHBoeXNpY3NUaW1lfSBhcyBhIGJhc2lzIG9mIGdhbWUvbG9naWMgY2FsY3VsYXRpb25zIGluc3RlYWQuXHJcbiAgICAgICAgKlxyXG4gICAgICAgICogQHByb3BlcnR5IHtudW1iZXJ9IGVsYXBzZWRcclxuICAgICAgICAqIEBzZWUgTGF6ZXIuVGltZS50aW1lXHJcbiAgICAgICAgKiBAcHJvdGVjdGVkXHJcbiAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmVsYXBzZWQgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLl9zdGFydFRpbWUgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmNhbGxiYWNrID0gbnVsbDtcclxuXHJcbiAgICAgICAgdGhpcy5jbG9ja3MgPSBuZXcgU2V0KCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGluaXQgKGNhbGxiYWNrKSB7XHJcblxyXG4gICAgICAgIHRoaXMudGltZSA9IHRoaXMuZ2V0VGltZSgpO1xyXG5cclxuICAgICAgICB0aGlzLl9zdGFydFRpbWUgPSB0aGlzLnRpbWU7XHJcblxyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcclxuXHJcbiAgICAgICAgLy8gIFRoaXMgc3RhcnRzIFJBRiBnb2luZyBhdXRvbWF0aWNhbGx5XHJcbiAgICAgICAgdGhpcy5yYWYuc3RhcnQobm93ID0+IHRoaXMuc3RlcChub3cpKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gIHRoaXMucmFmIHByb3ZpZGVzIHBlcmZvcm1hbmNlLm5vdyBhcyBhbiBhcmd1bWVudCAob3IgRGF0ZS5ub3cgdW5kZXIgU2V0VGltZW91dClcclxuICAgIHN0ZXAgKG5vdykge1xyXG5cclxuICAgICAgICB0aGlzLnByZXZUaW1lID0gdGhpcy50aW1lO1xyXG5cclxuICAgICAgICB0aGlzLnRpbWUgPSBub3c7XHJcblxyXG4gICAgICAgIHRoaXMuZWxhcHNlZCA9IHRoaXMudGltZSAtIHRoaXMucHJldlRpbWU7XHJcblxyXG4gICAgICAgIGZvciAoY29uc3QgY2xvY2sgb2YgdGhpcy5jbG9ja3MpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBjbG9jay5zdGVwKHRoaXMuZWxhcHNlZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmNhbGxiYWNrKCk7XHJcblxyXG4gICAgICAgIC8vICBGb3IgU2V0VGltZW91dCBSQUZcclxuICAgICAgICByZXR1cm4gMTY7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGFkZCAodGlja1NpemUgPSAwKSB7XHJcblxyXG4gICAgICAgIGxldCBjbG9jayA9IG5ldyBDbG9jayh0aGlzLCB0aWNrU2l6ZSk7XHJcblxyXG4gICAgICAgIHRoaXMuY2xvY2tzLmFkZChjbG9jayk7XHJcblxyXG4gICAgICAgIHJldHVybiBjbG9jaztcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlIChjbG9jaykge1xyXG5cclxuICAgICAgICB0aGlzLmNsb2Nrcy5kZWxldGUoY2xvY2spO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBkZXN0cm95ICgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHRvdGFsRWxhcHNlZCAoKSB7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLnRpbWUgLSB0aGlzLl9zdGFydFRpbWU7XHJcblxyXG4gICAgfVxyXG5cclxufVxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3RpbWUvTWFzdGVyQ2xvY2suanNcbiAqKi8iXSwic291cmNlUm9vdCI6IiJ9