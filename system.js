!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("system",[],t):"object"==typeof exports?exports.system=t():(e.lazer=e.lazer||{},e.lazer.system=t())}(this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}({0:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SignalGroup=t.SignalBinding=t.Signal=t.ParseXML=t.NOOP=t.MainLoop=t.EventDispatcher=void 0;var r=n(771),a=i(r),s=n(173),u=i(s),o=n(157),l=i(o),c=n(183),f=i(c),h=n(294),d=i(h),v=n(295),m=i(v),y=n(772),p=i(y);t.EventDispatcher=a["default"],t.MainLoop=u["default"],t.NOOP=l["default"],t.ParseXML=f["default"],t.Signal=d["default"],t.SignalBinding=m["default"],t.SignalGroup=p["default"]},156:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(157),u=i(s),o=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];r(this,e),this.root=t,this.forceSetTimeOut=n,n||(this.forceSetTimeOut=!this.normalizeRaf()),this._running=!1,this._timeOutID=null,this._callback=u["default"]}return a(e,[{key:"start",value:function(e){var t=this;this._running||(this._running=!0,this._callback=e,this.usingSetTimeout?this._timeOutID=this.root.setTimeout(function(e){return t.updateSetTimeout(Date.now())},0):this._timeOutID=this.root.requestAnimationFrame(function(e){return t.updateRAF(e)}))}},{key:"updateRAF",value:function(e){var t=this;this._callback(e),this._timeOutID=this.root.requestAnimationFrame(function(e){return t.updateRAF(e)})}},{key:"updateSetTimeout",value:function(e){var t=this;this._timeOutID=this.root.setTimeout(function(e){return t.updateSetTimeout(Date.now())},0)}},{key:"stop",value:function(){this._running&&(this.usingSetTimeout?this.root.clearTimeout(this._timeOutID):this.root.cancelAnimationFrame(this._timeOutID),this._running=!1)}},{key:"normalizeRaf",value:function(){if(this.root.requestAnimationFrame)return!0;for(var e=["ms","moz","webkit","o"],t=0;t<e.length;t++){var n=e[t];return this.root.requestAnimationFrame=this.root[n]+"RequestAnimationFrame",this.root.cancelAnimationFrame=this.root[n]+"CancelAnimationFrame",!0}return!1}},{key:"usingSetTimeout",get:function(){return this.forceSetTimeOut}},{key:"usingRAF",get:function(){return!this.forceSetTimeOut}},{key:"isRunning",get:function(){return this._running},set:function(e){e?this.start():this.stop()}}]),e}();t["default"]=o},157:function(e,t){"use strict";function n(){}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},173:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(156),u=i(s),o=n(157),l=i(o),c=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?60:arguments[0];r(this,e),this.getTime=Date.now,window.performance&&(window.performance.now?this.getTime=function(){return window.performance.now()}:window.performance.webkitNow&&(this.getTime=function(){return window.performance.webkitNow()})),this.timestep=1e3/t,this.physicsStep=1/t,this.frameDelta=0,this.lastFrameTimeMs=0,this.fps=60,this.lastFpsUpdate=0,this.framesThisSecond=0,this.numUpdateSteps=0,this.minFrameDelay=0,this.running=!1,this.started=!1,this.panic=!1,this.begin=l["default"],this.update=l["default"],this.draw=l["default"],this.end=l["default"],this.raf=new u["default"](window,!1)}return a(e,[{key:"resetFrameDelta",value:function(){var e=this.frameDelta;return this.frameDelta=0,e}},{key:"start",value:function(){var e=this;return this.started?this:(this.started=!0,this.running=!0,this.lastFrameTimeMs=this.getTime(),this.lastFpsUpdate=this.getTime(),this.framesThisSecond=0,void this.raf.start(function(t){return e.step(t)}))}},{key:"step",value:function(e){if(!(e<this.lastFrameTimeMs+this.minFrameDelay)){for(this.frameDelta+=e-this.lastFrameTimeMs,this.lastFrameTimeMs=e,this.begin(e,this.frameDelta),e>this.lastFpsUpdate+1e3&&(this.fps=.25*this.framesThisSecond+.75*this.fps,this.lastFpsUpdate=e,this.framesThisSecond=0),this.framesThisSecond++,this.numUpdateSteps=0;this.frameDelta>=this.timestep;)if(this.update(this.timestep),this.frameDelta-=this.timestep,++this.numUpdateSteps>=240){this.panic=!0;break}this.draw(this.frameDelta/this.timestep),this.end(this.fps,this.panic),this.panic=!1}}},{key:"stop",value:function(){return this.running=!1,this.started=!1,this.raf.stop(),this}},{key:"maxFPS",get:function(){return 1e3/this.minFrameDelay},set:function(){var e=arguments.length<=0||void 0===arguments[0]?1/0:arguments[0];0===e?this.stop():this.minFrameDelay=1e3/e}},{key:"isRunning",get:function(){return this.running}}]),e}();t["default"]=c},183:function(e,t){"use strict";function n(e){var t="";try{if(window.DOMParser){var n=new DOMParser;t=n.parseFromString(e,"text/xml")}else t=new ActiveXObject("Microsoft.XMLDOM"),t.loadXML(e)}catch(i){t=null}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length?t:null}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},294:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(295),u=i(s),o=function(){function e(){r(this,e),this.callbacks=new Map,this.prevParams=[],this.memorize=!1,this.active=!0,this.propagate=!0}return a(e,[{key:"validate",value:function(e,t){if("function"!=typeof e)return console.warn("Signal.add: listener argument is required and should be a Function."),!1;var n=!0,i=!1,r=void 0;try{for(var a,s=this.callbacks.keys()[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var u=a.value;if(u.listener===e){if(u.isOnce)return console.warn("Signal.add: You already have the given listener bound 'isOnce' to this Signal."),!1;if(t)return console.warn("Signal.addOnce: You cannot addOnce a listener that is already bound to this Signal."),!1}}}catch(o){i=!0,r=o}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw r}}return!0}},{key:"add",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];return this.register(e,!1,n)}},{key:"addOnce",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];return this.register(e,!0,n)}},{key:"register",value:function(e,t,n){if(!this.validate(e,!1))return null;var i=new u["default"](this,e,!1,n);return this.callbacks.set(i,e),this.memorize&&this.prevParams.length>0&&i.execute(this.prevParams),i}},{key:"dispatch",value:function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];this.memorize&&(this.prevParams=t);var i=!0,r=!1,a=void 0;try{for(var s,u=this.callbacks.keys()[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var o=s.value,l=!0;if(o.active&&(l=o.execute(t)),!this.propagate||!l)return}}catch(c){r=!0,a=c}finally{try{!i&&u["return"]&&u["return"]()}finally{if(r)throw a}}}},{key:"remove",value:function(e){e.destroy(),this.callbacks["delete"](e)}},{key:"removeAll",value:function(){var e=!0,t=!1,n=void 0;try{for(var i,r=this.callbacks.keys()[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var a=i.value;a.destroy()}}catch(s){t=!0,n=s}finally{try{!e&&r["return"]&&r["return"]()}finally{if(t)throw n}}this.callbacks.clear()}},{key:"halt",value:function(){this.propagate=!1}},{key:"has",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,a=this.callbacks.keys()[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s=r.value;if(s.listener===e)return!0}}catch(u){n=!0,i=u}finally{try{!t&&a["return"]&&a["return"]()}finally{if(n)throw i}}return!1}},{key:"forget",value:function(){this.prevParams=[]}},{key:"getNumListeners",value:function(){return this.callbacks.size}},{key:"destroy",value:function(){this.removeAll(),this.forget(),this.callbacks=null}},{key:"hasListeners",get:function(){return this.callbacks.size>0}}]),e}();t["default"]=o},295:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t,i){var r=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],a=arguments.length<=3||void 0===arguments[3]?[]:arguments[3];n(this,e),this.signal=t,this.listener=i,this.isOnce=r,this.args=a,this.active=!0}return i(e,[{key:"execute",value:function(e){var t=this.listener.apply(null,e.concat(this.args));return this.isOnce&&this.signal.remove(this),t}},{key:"destroy",value:function(){this.signal=null,this.listener=null,this.args=null,this.active=!1}}]),e}();t["default"]=r},771:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(294),u=(i(s),function(){function e(){r(this,e)}return a(e,[{key:"add",value:function(e,t){}},{key:"remove",value:function(e,t){}},{key:"dispatch",value:function(){}}]),e}());t["default"]=u},772:function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(294),u=i(s),o=function(){function e(){r(this,e),this.signals=new Set}return a(e,[{key:"add",value:function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];var i=!0,r=!1,a=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var o=s.value;this.signals.add(o)}}catch(l){r=!0,a=l}finally{try{!i&&u["return"]&&u["return"]()}finally{if(r)throw a}}}},{key:"create",value:function(){var e=new u["default"];return this.signals.add(e),e}},{key:"remove",value:function(e){this.signals["delete"](e)}},{key:"removeAll",value:function(){this.signals.clear()}},{key:"listen",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,a=this.signals[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var s=r.value;s.add(e)}}catch(u){n=!0,i=u}finally{try{!t&&a["return"]&&a["return"]()}finally{if(n)throw i}}}}]),e}();t["default"]=o}})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uPzVjYTYqKioqKioqKioqKioqKioqKiIsIndlYnBhY2s6Ly8vc3lzdGVtLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCAxYjZmNThhMTc3NDUwODBmMDAxYT83NzllKioqKioqKioqKioqKioqKioiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N5c3RlbS9pbmRleC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZG9tL1JlcXVlc3RBbmltYXRpb25GcmFtZS5qcz81ZWM1KiIsIndlYnBhY2s6Ly8vLi9zcmMvc3lzdGVtL05PT1AuanM/MWNmZCoqIiwid2VicGFjazovLy8uL3NyYy9zeXN0ZW0vTWFpbkxvb3AuanM/YzU5NiIsIndlYnBhY2s6Ly8vLi9zcmMvc3lzdGVtL1BhcnNlWE1MLmpzP2M1OWUqIiwid2VicGFjazovLy8uL3NyYy9zeXN0ZW0vU2lnbmFsLmpzP2RiN2QiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N5c3RlbS9TaWduYWxCaW5kaW5nLmpzP2Q5NmQiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N5c3RlbS9FdmVudERpc3BhdGNoZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3N5c3RlbS9TaWduYWxHcm91cC5qcyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJ0aGlzIiwibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJpZCIsImxvYWRlZCIsImNhbGwiLCJtIiwiYyIsInAiLCIwIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ2YWx1ZSIsIlNpZ25hbEdyb3VwIiwiU2lnbmFsQmluZGluZyIsIlNpZ25hbCIsIlBhcnNlWE1MIiwiTk9PUCIsIk1haW5Mb29wIiwiRXZlbnREaXNwYXRjaGVyIiwidW5kZWZpbmVkIiwiX0V2ZW50RGlzcGF0Y2hlciIsIl9FdmVudERpc3BhdGNoZXIyIiwiX01haW5Mb29wIiwiX01haW5Mb29wMiIsIl9OT09QIiwiX05PT1AyIiwiX1BhcnNlWE1MIiwiX1BhcnNlWE1MMiIsIl9TaWduYWwiLCJfU2lnbmFsMiIsIl9TaWduYWxCaW5kaW5nIiwiX1NpZ25hbEJpbmRpbmcyIiwiX1NpZ25hbEdyb3VwIiwiX1NpZ25hbEdyb3VwMiIsIjE1NiIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIlJlcXVlc3RBbmltYXRpb25GcmFtZSIsImZvcmNlU2V0VGltZU91dCIsImFyZ3VtZW50cyIsIm5vcm1hbGl6ZVJhZiIsIl9ydW5uaW5nIiwiX3RpbWVPdXRJRCIsIl9jYWxsYmFjayIsImNhbGxiYWNrIiwiX3RoaXMiLCJ1c2luZ1NldFRpbWVvdXQiLCJzZXRUaW1lb3V0Iiwibm93IiwidXBkYXRlU2V0VGltZW91dCIsIkRhdGUiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJ1cGRhdGVSQUYiLCJfdGhpczIiLCJfdGhpczMiLCJjbGVhclRpbWVvdXQiLCJjYW5jZWxBbmltYXRpb25GcmFtZSIsIl9hcnIiLCJfaSIsInZlbmRvciIsImdldCIsInNldCIsInN0YXJ0Iiwic3RvcCIsIjE1NyIsIjE3MyIsIl9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJfUmVxdWVzdEFuaW1hdGlvbkZyYW1lMiIsImZyYW1lcmF0ZSIsImdldFRpbWUiLCJ3aW5kb3ciLCJwZXJmb3JtYW5jZSIsIndlYmtpdE5vdyIsInRpbWVzdGVwIiwicGh5c2ljc1N0ZXAiLCJmcmFtZURlbHRhIiwibGFzdEZyYW1lVGltZU1zIiwiZnBzIiwibGFzdEZwc1VwZGF0ZSIsImZyYW1lc1RoaXNTZWNvbmQiLCJudW1VcGRhdGVTdGVwcyIsIm1pbkZyYW1lRGVsYXkiLCJydW5uaW5nIiwic3RhcnRlZCIsInBhbmljIiwiYmVnaW4iLCJ1cGRhdGUiLCJkcmF3IiwiZW5kIiwicmFmIiwib2xkRnJhbWVEZWx0YSIsInN0ZXAiLCJ0aW1lc3RhbXAiLCJJbmZpbml0eSIsIjE4MyIsImRhdGEiLCJ4bWwiLCJkb21wYXJzZXIiLCJET01QYXJzZXIiLCJwYXJzZUZyb21TdHJpbmciLCJBY3RpdmVYT2JqZWN0IiwibG9hZFhNTCIsImUiLCJkb2N1bWVudEVsZW1lbnQiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsIjI5NCIsImNhbGxiYWNrcyIsIk1hcCIsInByZXZQYXJhbXMiLCJtZW1vcml6ZSIsImFjdGl2ZSIsInByb3BhZ2F0ZSIsImxpc3RlbmVyIiwiaXNPbmNlIiwiY29uc29sZSIsIndhcm4iLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uIiwiX2RpZEl0ZXJhdG9yRXJyb3IiLCJfaXRlcmF0b3JFcnJvciIsIl9zdGVwIiwiX2l0ZXJhdG9yIiwia2V5cyIsIlN5bWJvbCIsIml0ZXJhdG9yIiwibmV4dCIsImRvbmUiLCJiaW5kaW5nIiwiZXJyIiwiX2xlbiIsImFyZ3MiLCJBcnJheSIsIl9rZXkiLCJyZWdpc3RlciIsIl9sZW4yIiwiX2tleTIiLCJ2YWxpZGF0ZSIsImV4ZWN1dGUiLCJfbGVuMyIsIl9rZXkzIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIiLCJfZGlkSXRlcmF0b3JFcnJvcjIiLCJfaXRlcmF0b3JFcnJvcjIiLCJfc3RlcDIiLCJfaXRlcmF0b3IyIiwicmVzdWx0IiwiZGVzdHJveSIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zIiwiX2RpZEl0ZXJhdG9yRXJyb3IzIiwiX2l0ZXJhdG9yRXJyb3IzIiwiX3N0ZXAzIiwiX2l0ZXJhdG9yMyIsImNsZWFyIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjQiLCJfZGlkSXRlcmF0b3JFcnJvcjQiLCJfaXRlcmF0b3JFcnJvcjQiLCJfc3RlcDQiLCJfaXRlcmF0b3I0Iiwic2l6ZSIsInJlbW92ZUFsbCIsImZvcmdldCIsIjI5NSIsInNpZ25hbCIsImFwcGx5IiwiY29uY2F0IiwicmVtb3ZlIiwiNzcxIiwiZXZlbnQiLCI3NzIiLCJzaWduYWxzIiwiU2V0IiwiYXJnIiwiYWRkIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxHQUNBLGdCQUFBQyxVQUFBLGdCQUFBQyxRQUNBQSxPQUFBRCxRQUFBRCxJQUNBLGtCQUFBRyxnQkFBQUMsSUFDQUQsT0FBQSxZQUFBSCxHQUNBLGdCQUFBQyxTQUNBQSxRQUFBLE9BQUFELEtBRUFELEVBQUEsTUFBQUEsRUFBQSxVQUFxQ0EsRUFBQSxhQUFBQyxNQUNwQ0ssS0FBQSxXQUNELE1DQWdCLFVBQVVDLEdDTjFCLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBUCxPQUdBLElBQUFDLEdBQUFPLEVBQUFELElBQ0FQLFdBQ0FTLEdBQUFGLEVBQ0FHLFFBQUEsRUFVQSxPQU5BTCxHQUFBRSxHQUFBSSxLQUFBVixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBTSxHQUdBTCxFQUFBUyxRQUFBLEVBR0FULEVBQUFELFFBdkJBLEdBQUFRLEtBcUNBLE9BVEFGLEdBQUFNLEVBQUFQLEVBR0FDLEVBQUFPLEVBQUFMLEVBR0FGLEVBQUFRLEVBQUEsR0FHQVIsRUFBQSxLRGdCTVMsRUFDQSxTQUFTZCxFQUFRRCxFQUFTTSxHQUUvQixZQW1DQSxTQUFTVSxHQUF1QkMsR0FBTyxNQUFPQSxJQUFPQSxFQUFJQyxXQUFhRCxHQUFRRSxVQUFTRixHQWpDdkZHLE9BQU9DLGVBQWVyQixFQUFTLGNBQzNCc0IsT0FBTyxJQUVYdEIsRUFBUXVCLFlBQWN2QixFQUFRd0IsY0FBZ0J4QixFQUFReUIsT0FBU3pCLEVBQVEwQixTQUFX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S0FDSWxCLE1BQUsrTCxRQUFRRyxJQUFJRCxJQUpYLE1BQUEzQyxHQUFBVixHQUFBLEVBQUFDLEVBQUFTLEVBQUEsYUFBQVgsR0FBQUksMkJBQUEsV0FBQUgsRUFBQSxLQUFBQyxRVjY5QlRyRixJQUFLLFNBQ0x0QyxNQUFPLFdVbDlCUixHQUFJc0ssR0FBUyxHQUFBcEosYUFJYixPQUZBcEMsTUFBSytMLFFBQVFHLElBQUlWLEdBRVZBLEtWdTlCTmhJLElBQUssU0FDTHRDLE1BQU8sU1VwOUJKc0ssR0FFSnhMLEtBQUsrTCxRQUFML0wsVUFBb0J3TCxNVnU5Qm5CaEksSUFBSyxZQUNMdEMsTUFBTyxXVWw5QlJsQixLQUFLK0wsUUFBUWpCLFdWdTlCWnRILElBQUssU0FDTHRDLE1BQU8sU1VwOUJKcUgsR0FBVSxHQUFBMkIsSUFBQSxFQUFBQyxHQUFBLEVBQUFDLEVBQUExSSxNQUFBLEtBRWQsT0FBQTJJLEdBQUFDLEVBQW1CdEssS0FBSytMLFFBQXhCOUMsT0FBQUMsY0FBQWdCLEdBQUFHLEVBQUFDLEVBQUFuQixRQUFBQyxNQUFBYyxHQUFBLEVBQ0EsSUFEU3NCLEdBQ1RuQixFQUFBbkosS0FDSXNLLEdBQU9VLElBQUkzRCxJQUpELE1BQUFlLEdBQUFhLEdBQUEsRUFBQUMsRUFBQWQsRUFBQSxhQUFBWSxHQUFBSSwyQkFBQSxXQUFBSCxFQUFBLEtBQUFDLFNWaS9CVmpKLElBR1h2QixjVTVoQ29CdUIiLCJmaWxlIjoic3lzdGVtLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoXCJzeXN0ZW1cIiwgW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wic3lzdGVtXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcImxhemVyXCJdID0gcm9vdFtcImxhemVyXCJdIHx8IHt9LCByb290W1wibGF6ZXJcIl1bXCJzeXN0ZW1cIl0gPSBmYWN0b3J5KCk7XG59KSh0aGlzLCBmdW5jdGlvbigpIHtcbnJldHVybiBcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiB3ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb25cbiAqKi8iLCIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShcInN5c3RlbVwiLCBbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJzeXN0ZW1cIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wibGF6ZXJcIl0gPSByb290W1wibGF6ZXJcIl0gfHwge30sIHJvb3RbXCJsYXplclwiXVtcInN5c3RlbVwiXSA9IGZhY3RvcnkoKTtcbn0pKHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoe1xuXG4vKioqLyAwOlxuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0ZXhwb3J0cy5TaWduYWxHcm91cCA9IGV4cG9ydHMuU2lnbmFsQmluZGluZyA9IGV4cG9ydHMuU2lnbmFsID0gZXhwb3J0cy5QYXJzZVhNTCA9IGV4cG9ydHMuTk9PUCA9IGV4cG9ydHMuTWFpbkxvb3AgPSBleHBvcnRzLkV2ZW50RGlzcGF0Y2hlciA9IHVuZGVmaW5lZDtcblx0XG5cdHZhciBfRXZlbnREaXNwYXRjaGVyID0gX193ZWJwYWNrX3JlcXVpcmVfXyg3NzEpO1xuXHRcblx0dmFyIF9FdmVudERpc3BhdGNoZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfRXZlbnREaXNwYXRjaGVyKTtcblx0XG5cdHZhciBfTWFpbkxvb3AgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE3Myk7XG5cdFxuXHR2YXIgX01haW5Mb29wMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX01haW5Mb29wKTtcblx0XG5cdHZhciBfTk9PUCA9IF9fd2VicGFja19yZXF1aXJlX18oMTU3KTtcblx0XG5cdHZhciBfTk9PUDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9OT09QKTtcblx0XG5cdHZhciBfUGFyc2VYTUwgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE4Myk7XG5cdFxuXHR2YXIgX1BhcnNlWE1MMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1BhcnNlWE1MKTtcblx0XG5cdHZhciBfU2lnbmFsID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOTQpO1xuXHRcblx0dmFyIF9TaWduYWwyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfU2lnbmFsKTtcblx0XG5cdHZhciBfU2lnbmFsQmluZGluZyA9IF9fd2VicGFja19yZXF1aXJlX18oMjk1KTtcblx0XG5cdHZhciBfU2lnbmFsQmluZGluZzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9TaWduYWxCaW5kaW5nKTtcblx0XG5cdHZhciBfU2lnbmFsR3JvdXAgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDc3Mik7XG5cdFxuXHR2YXIgX1NpZ25hbEdyb3VwMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1NpZ25hbEdyb3VwKTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRleHBvcnRzLkV2ZW50RGlzcGF0Y2hlciA9IF9FdmVudERpc3BhdGNoZXIyLmRlZmF1bHQ7XG5cdGV4cG9ydHMuTWFpbkxvb3AgPSBfTWFpbkxvb3AyLmRlZmF1bHQ7XG5cdGV4cG9ydHMuTk9PUCA9IF9OT09QMi5kZWZhdWx0O1xuXHRleHBvcnRzLlBhcnNlWE1MID0gX1BhcnNlWE1MMi5kZWZhdWx0O1xuXHRleHBvcnRzLlNpZ25hbCA9IF9TaWduYWwyLmRlZmF1bHQ7XG5cdGV4cG9ydHMuU2lnbmFsQmluZGluZyA9IF9TaWduYWxCaW5kaW5nMi5kZWZhdWx0O1xuXHRleHBvcnRzLlNpZ25hbEdyb3VwID0gX1NpZ25hbEdyb3VwMi5kZWZhdWx0O1xuXG4vKioqLyB9LFxuXG4vKioqLyAxNTY6XG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdHZhciBfTk9PUCA9IF9fd2VicGFja19yZXF1aXJlX18oMTU3KTtcblx0XG5cdHZhciBfTk9PUDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9OT09QKTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXHRcblx0dmFyIFJlcXVlc3RBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIFJlcXVlc3RBbmltYXRpb25GcmFtZShyb290KSB7XG5cdCAgICAgICAgdmFyIGZvcmNlU2V0VGltZU91dCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMSB8fCBhcmd1bWVudHNbMV0gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzFdO1xuXHRcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmVxdWVzdEFuaW1hdGlvbkZyYW1lKTtcblx0XG5cdCAgICAgICAgdGhpcy5yb290ID0gcm9vdDtcblx0ICAgICAgICB0aGlzLmZvcmNlU2V0VGltZU91dCA9IGZvcmNlU2V0VGltZU91dDtcblx0XG5cdCAgICAgICAgLy8gIElmIHRoZXJlJ3Mgbm8gd2luZG93IG9iamVjdCBvciBSQUYgdGhlbiB3ZSBoYXZlIHRvIHVzZSBTVCBhbnl3YXlcblx0ICAgICAgICBpZiAoIWZvcmNlU2V0VGltZU91dCkge1xuXHQgICAgICAgICAgICB0aGlzLmZvcmNlU2V0VGltZU91dCA9ICF0aGlzLm5vcm1hbGl6ZVJhZigpO1xuXHQgICAgICAgIH1cblx0XG5cdCAgICAgICAgdGhpcy5fcnVubmluZyA9IGZhbHNlO1xuXHQgICAgICAgIHRoaXMuX3RpbWVPdXRJRCA9IG51bGw7XG5cdCAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBfTk9PUDIuZGVmYXVsdDtcblx0ICAgIH1cblx0XG5cdCAgICAvLyAgVW5kZXIgU2V0VGltZW91dCB0aGUgY2FsbGJhY2sgbXVzdCByZXR1cm4gdGhlIG1zIHZhbHVlIG9mIHdoZW4gdG8gcnVuIHRoZSBuZXh0IHVwZGF0ZVxuXHRcblx0XG5cdCAgICBfY3JlYXRlQ2xhc3MoUmVxdWVzdEFuaW1hdGlvbkZyYW1lLCBbe1xuXHQgICAgICAgIGtleTogJ3N0YXJ0Jyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RhcnQoY2FsbGJhY2spIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblx0XG5cdCAgICAgICAgICAgIGlmICghdGhpcy5fcnVubmluZykge1xuXHQgICAgICAgICAgICAgICAgdGhpcy5fcnVubmluZyA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICB0aGlzLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xuXHRcblx0ICAgICAgICAgICAgICAgIGlmICh0aGlzLnVzaW5nU2V0VGltZW91dCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVPdXRJRCA9IHRoaXMucm9vdC5zZXRUaW1lb3V0KGZ1bmN0aW9uIChub3cpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnVwZGF0ZVNldFRpbWVvdXQoRGF0ZS5ub3coKSk7XG5cdCAgICAgICAgICAgICAgICAgICAgfSwgMCk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVPdXRJRCA9IHRoaXMucm9vdC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24gKG5vdykge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMudXBkYXRlUkFGKG5vdyk7XG5cdCAgICAgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAndXBkYXRlUkFGJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlUkFGKG5vdykge1xuXHQgICAgICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblx0XG5cdCAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrKG5vdyk7XG5cdFxuXHQgICAgICAgICAgICB0aGlzLl90aW1lT3V0SUQgPSB0aGlzLnJvb3QucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uIChub3cpIHtcblx0ICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIudXBkYXRlUkFGKG5vdyk7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICd1cGRhdGVTZXRUaW1lb3V0Jyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlU2V0VGltZW91dChub3cpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICB0aGlzLl90aW1lT3V0SUQgPSB0aGlzLnJvb3Quc2V0VGltZW91dChmdW5jdGlvbiAobm93KSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMzLnVwZGF0ZVNldFRpbWVvdXQoRGF0ZS5ub3coKSk7XG5cdCAgICAgICAgICAgIH0sIDApO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdzdG9wJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RvcCgpIHtcblx0XG5cdCAgICAgICAgICAgIGlmICh0aGlzLl9ydW5uaW5nKSB7XG5cdCAgICAgICAgICAgICAgICBpZiAodGhpcy51c2luZ1NldFRpbWVvdXQpIHtcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLnJvb3QuY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVPdXRJRCk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgIHRoaXMucm9vdC5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLl90aW1lT3V0SUQpO1xuXHQgICAgICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgICAgIHRoaXMuX3J1bm5pbmcgPSBmYWxzZTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdub3JtYWxpemVSYWYnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBub3JtYWxpemVSYWYoKSB7XG5cdFxuXHQgICAgICAgICAgICBpZiAodGhpcy5yb290LnJlcXVlc3RBbmltYXRpb25GcmFtZSkge1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgX2FyciA9IFsnbXMnLCAnbW96JywgJ3dlYmtpdCcsICdvJ107XG5cdFxuXHQgICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IF9hcnIubGVuZ3RoOyBfaSsrKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdmFyIHZlbmRvciA9IF9hcnJbX2ldO1xuXHQgICAgICAgICAgICAgICAgICAgIGlmICh0cnVlKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucm9vdC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSB0aGlzLnJvb3RbdmVuZG9yXSArICdSZXF1ZXN0QW5pbWF0aW9uRnJhbWUnO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJvb3QuY2FuY2VsQW5pbWF0aW9uRnJhbWUgPSB0aGlzLnJvb3RbdmVuZG9yXSArICdDYW5jZWxBbmltYXRpb25GcmFtZSc7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICd1c2luZ1NldFRpbWVvdXQnLFxuXHQgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm9yY2VTZXRUaW1lT3V0O1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICd1c2luZ1JBRicsXG5cdCAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gIXRoaXMuZm9yY2VTZXRUaW1lT3V0O1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdpc1J1bm5pbmcnLFxuXHQgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3J1bm5pbmc7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuXHRcblx0ICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG5cdCAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0KCk7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICB0aGlzLnN0b3AoKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgIH1dKTtcblx0XG5cdCAgICByZXR1cm4gUmVxdWVzdEFuaW1hdGlvbkZyYW1lO1xuXHR9KCk7XG5cdFxuXHRleHBvcnRzLmRlZmF1bHQgPSBSZXF1ZXN0QW5pbWF0aW9uRnJhbWU7XG5cbi8qKiovIH0sXG5cbi8qKiovIDE1Nzpcbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0ZXhwb3J0cy5kZWZhdWx0ID0gTk9PUDtcblx0Ly8gSW4gYWxsIG1ham9yIGJyb3dzZXJzLCByZXBsYWNpbmcgbm9uLXNwZWNpZmllZCBmdW5jdGlvbnMgd2l0aCBOT09Qc1xuXHQvLyBzZWVtcyB0byBiZSBhcyBmYXN0IG9yIHNsaWdodGx5IGZhc3RlciB0aGFuIHVzaW5nIGNvbmRpdGlvbnMgdG8gb25seVxuXHQvLyBjYWxsIHRoZSBmdW5jdGlvbnMgaWYgdGhleSBhcmUgc3BlY2lmaWVkLiBUaGlzIGlzIHByb2JhYmx5IGR1ZSB0byBlbXB0eVxuXHQvLyBmdW5jdGlvbnMgYmVpbmcgb3B0aW1pemVkIGF3YXkuIGh0dHA6Ly9qc3BlcmYuY29tL25vb3AtdnMtY29uZGl0aW9uXG5cdFxuXHRmdW5jdGlvbiBOT09QKCkge1xuXHRcblx0ICAgIC8vICBUaGF0J3MgcmlnaHQsIHRoZXJlJ3Mgbm90aGluZyBoZXJlLlxuXHRcblx0fVxuXG4vKioqLyB9LFxuXG4vKioqLyAxNzM6XG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgICAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cdFxuXHR2YXIgX1JlcXVlc3RBbmltYXRpb25GcmFtZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTU2KTtcblx0XG5cdHZhciBfUmVxdWVzdEFuaW1hdGlvbkZyYW1lMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1JlcXVlc3RBbmltYXRpb25GcmFtZSk7XG5cdFxuXHR2YXIgX05PT1AgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1Nyk7XG5cdFxuXHR2YXIgX05PT1AyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfTk9PUCk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdC8vICBNeSB0aGFua3MgdG8gSXNhYWMgU3VraW4gZm9yIHNvbWUgb2YgdGhlIGNvbmNlcHRzIHVzZWQgaW4gdGhpcyBjbGFzc1xuXHRcblx0dmFyIE1haW5Mb29wID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGZ1bmN0aW9uIE1haW5Mb29wKCkge1xuXHQgICAgICAgICAgICAgICAgdmFyIGZyYW1lcmF0ZSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IDYwIDogYXJndW1lbnRzWzBdO1xuXHRcblx0ICAgICAgICAgICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNYWluTG9vcCk7XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gIE1vdmUgdG8gZXh0ZXJuYWwgZmlsZSBvbmNlIHRlc3RlZFxuXHQgICAgICAgICAgICAgICAgdGhpcy5nZXRUaW1lID0gRGF0ZS5ub3c7XG5cdFxuXHQgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5wZXJmb3JtYW5jZSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LnBlcmZvcm1hbmNlLm5vdykge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0VGltZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cucGVyZm9ybWFuY2Uud2Via2l0Tm93KSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRUaW1lID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5wZXJmb3JtYW5jZS53ZWJraXROb3coKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgdGhpcy50aW1lc3RlcCA9IDEwMDAgLyBmcmFtZXJhdGU7XG5cdCAgICAgICAgICAgICAgICB0aGlzLnBoeXNpY3NTdGVwID0gMSAvIGZyYW1lcmF0ZTtcblx0XG5cdCAgICAgICAgICAgICAgICAvLyBUaGUgY3VtdWxhdGl2ZSBhbW91bnQgb2YgaW4tYXBwIHRpbWUgdGhhdCBoYXNuJ3QgYmVlbiBzaW11bGF0ZWQgeWV0LlxuXHQgICAgICAgICAgICAgICAgLy8gU2VlIHRoZSBjb21tZW50cyBpbnNpZGUgYW5pbWF0ZSgpIGZvciBkZXRhaWxzLlxuXHQgICAgICAgICAgICAgICAgdGhpcy5mcmFtZURlbHRhID0gMDtcblx0XG5cdCAgICAgICAgICAgICAgICAvLyBUaGUgdGltZXN0YW1wIGluIG1pbGxpc2Vjb25kcyBvZiB0aGUgbGFzdCB0aW1lIHRoZSBtYWluIGxvb3Agd2FzIHJ1bi5cblx0ICAgICAgICAgICAgICAgIC8vIFVzZWQgdG8gY29tcHV0ZSB0aGUgdGltZSBlbGFwc2VkIGJldHdlZW4gZnJhbWVzLlxuXHQgICAgICAgICAgICAgICAgdGhpcy5sYXN0RnJhbWVUaW1lTXMgPSAwO1xuXHRcblx0ICAgICAgICAgICAgICAgIC8vIEFuIGV4cG9uZW50aWFsIG1vdmluZyBhdmVyYWdlIG9mIHRoZSBmcmFtZXMgcGVyIHNlY29uZC5cblx0ICAgICAgICAgICAgICAgIHRoaXMuZnBzID0gNjA7XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gVGhlIHRpbWVzdGFtcCAoaW4gbWlsbGlzZWNvbmRzKSBvZiB0aGUgbGFzdCB0aW1lIHRoZSBgZnBzYCBtb3Zpbmdcblx0ICAgICAgICAgICAgICAgIC8vIGF2ZXJhZ2Ugd2FzIHVwZGF0ZWQuXG5cdCAgICAgICAgICAgICAgICB0aGlzLmxhc3RGcHNVcGRhdGUgPSAwO1xuXHRcblx0ICAgICAgICAgICAgICAgIC8vIFRoZSBudW1iZXIgb2YgZnJhbWVzIGRlbGl2ZXJlZCBpbiB0aGUgY3VycmVudCBzZWNvbmQuXG5cdCAgICAgICAgICAgICAgICB0aGlzLmZyYW1lc1RoaXNTZWNvbmQgPSAwO1xuXHRcblx0ICAgICAgICAgICAgICAgIC8vIFRoZSBudW1iZXIgb2YgdGltZXMgdXBkYXRlKCkgaXMgY2FsbGVkIGluIGEgZ2l2ZW4gZnJhbWUuIFRoaXMgaXMgb25seVxuXHQgICAgICAgICAgICAgICAgLy8gcmVsZXZhbnQgaW5zaWRlIG9mIGFuaW1hdGUoKSwgYnV0IGEgcmVmZXJlbmNlIGlzIGhlbGQgZXh0ZXJuYWxseSBzbyB0aGF0XG5cdCAgICAgICAgICAgICAgICAvLyB0aGlzIHZhcmlhYmxlIGlzIG5vdCBtYXJrZWQgZm9yIGdhcmJhZ2UgY29sbGVjdGlvbiBldmVyeSB0aW1lIHRoZSBtYWluXG5cdCAgICAgICAgICAgICAgICAvLyBsb29wIHJ1bnMuXG5cdCAgICAgICAgICAgICAgICB0aGlzLm51bVVwZGF0ZVN0ZXBzID0gMDtcblx0XG5cdCAgICAgICAgICAgICAgICAvLyBUaGUgbWluaW11bSBhbW91bnQgb2YgdGltZSBpbiBtaWxsaXNlY29uZHMgdGhhdCBtdXN0IHBhc3Mgc2luY2UgdGhlIGxhc3Rcblx0ICAgICAgICAgICAgICAgIC8vIGZyYW1lIHdhcyBleGVjdXRlZCBiZWZvcmUgYW5vdGhlciBmcmFtZSBjYW4gYmUgZXhlY3V0ZWQuIFRoZVxuXHQgICAgICAgICAgICAgICAgLy8gbXVsdGlwbGljYXRpdmUgaW52ZXJzZSBjYXBzIHRoZSBGUFMgKHRoZSBkZWZhdWx0IG9mIHplcm8gbWVhbnMgdGhlcmUgaXNcblx0ICAgICAgICAgICAgICAgIC8vIG5vIGNhcCkuXG5cdCAgICAgICAgICAgICAgICB0aGlzLm1pbkZyYW1lRGVsYXkgPSAwO1xuXHRcblx0ICAgICAgICAgICAgICAgIC8vIFdoZXRoZXIgdGhlIG1haW4gbG9vcCBpcyBydW5uaW5nLlxuXHQgICAgICAgICAgICAgICAgdGhpcy5ydW5uaW5nID0gZmFsc2U7XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gYHRydWVgIGlmIGBNYWluTG9vcC5zdGFydCgpYCBoYXMgYmVlbiBjYWxsZWQgYW5kIHRoZSBtb3N0IHJlY2VudCB0aW1lIGl0XG5cdCAgICAgICAgICAgICAgICAvLyB3YXMgY2FsbGVkIGhhcyBub3QgYmVlbiBmb2xsb3dlZCBieSBhIGNhbGwgdG8gYE1haW5Mb29wLnN0b3AoKWAuIFRoaXMgaXNcblx0ICAgICAgICAgICAgICAgIC8vIGRpZmZlcmVudCB0aGFuIGBydW5uaW5nYCBiZWNhdXNlIHRoZXJlIGlzIGEgZGVsYXkgb2YgYSBmZXcgbWlsbGlzZWNvbmRzXG5cdCAgICAgICAgICAgICAgICAvLyBhZnRlciBgTWFpbkxvb3Auc3RhcnQoKWAgaXMgY2FsbGVkIGJlZm9yZSB0aGUgYXBwbGljYXRpb24gaXMgY29uc2lkZXJlZFxuXHQgICAgICAgICAgICAgICAgLy8gXCJydW5uaW5nLlwiIFRoaXMgZGVsYXkgaXMgZHVlIHRvIHdhaXRpbmcgZm9yIHRoZSBuZXh0IGZyYW1lLlxuXHQgICAgICAgICAgICAgICAgdGhpcy5zdGFydGVkID0gZmFsc2U7XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gV2hldGhlciB0aGUgc2ltdWxhdGlvbiBoYXMgZmFsbGVuIHRvbyBmYXIgYmVoaW5kIHJlYWwgdGltZS5cblx0ICAgICAgICAgICAgICAgIC8vIFNwZWNpZmljYWxseSwgYHBhbmljYCB3aWxsIGJlIHNldCB0byBgdHJ1ZWAgaWYgdG9vIG1hbnkgdXBkYXRlcyBvY2N1ciBpblxuXHQgICAgICAgICAgICAgICAgLy8gb25lIGZyYW1lLiBUaGlzIGlzIG9ubHkgcmVsZXZhbnQgaW5zaWRlIG9mIGFuaW1hdGUoKSwgYnV0IGEgcmVmZXJlbmNlIGlzXG5cdCAgICAgICAgICAgICAgICAvLyBoZWxkIGV4dGVybmFsbHkgc28gdGhhdCB0aGlzIHZhcmlhYmxlIGlzIG5vdCBtYXJrZWQgZm9yIGdhcmJhZ2Vcblx0ICAgICAgICAgICAgICAgIC8vIGNvbGxlY3Rpb24gZXZlcnkgdGltZSB0aGUgbWFpbiBsb29wIHJ1bnMuXG5cdCAgICAgICAgICAgICAgICB0aGlzLnBhbmljID0gZmFsc2U7XG5cdFxuXHQgICAgICAgICAgICAgICAgLy8gQSBmdW5jdGlvbiB0aGF0IHJ1bnMgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgbWFpbiBsb29wLlxuXHQgICAgICAgICAgICAgICAgLy8gU2VlIGBNYWluTG9vcC5zZXRCZWdpbigpYCBmb3IgZGV0YWlscy5cblx0ICAgICAgICAgICAgICAgIHRoaXMuYmVnaW4gPSBfTk9PUDIuZGVmYXVsdDtcblx0XG5cdCAgICAgICAgICAgICAgICAvLyBBIGZ1bmN0aW9uIHRoYXQgcnVucyB1cGRhdGVzIChpLmUuIEFJIGFuZCBwaHlzaWNzKS5cblx0ICAgICAgICAgICAgICAgIC8vIFNlZSBgTWFpbkxvb3Auc2V0VXBkYXRlKClgIGZvciBkZXRhaWxzLlxuXHQgICAgICAgICAgICAgICAgdGhpcy51cGRhdGUgPSBfTk9PUDIuZGVmYXVsdDtcblx0XG5cdCAgICAgICAgICAgICAgICAvLyBBIGZ1bmN0aW9uIHRoYXQgZHJhd3MgdGhpbmdzIG9uIHRoZSBzY3JlZW4uXG5cdCAgICAgICAgICAgICAgICAvLyBTZWUgYE1haW5Mb29wLnNldERyYXcoKWAgZm9yIGRldGFpbHMuXG5cdCAgICAgICAgICAgICAgICB0aGlzLmRyYXcgPSBfTk9PUDIuZGVmYXVsdDtcblx0XG5cdCAgICAgICAgICAgICAgICAvLyBBIGZ1bmN0aW9uIHRoYXQgcnVucyBhdCB0aGUgZW5kIG9mIHRoZSBtYWluIGxvb3AuXG5cdCAgICAgICAgICAgICAgICAvLyBTZWUgYE1haW5Mb29wLnNldEVuZCgpYCBmb3IgZGV0YWlscy5cblx0ICAgICAgICAgICAgICAgIHRoaXMuZW5kID0gX05PT1AyLmRlZmF1bHQ7XG5cdFxuXHQgICAgICAgICAgICAgICAgdGhpcy5yYWYgPSBuZXcgX1JlcXVlc3RBbmltYXRpb25GcmFtZTIuZGVmYXVsdCh3aW5kb3csIGZhbHNlKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIF9jcmVhdGVDbGFzcyhNYWluTG9vcCwgW3tcblx0ICAgICAgICAgICAgICAgIGtleTogJ3Jlc2V0RnJhbWVEZWx0YScsXG5cdCAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVzZXRGcmFtZURlbHRhKCkge1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9sZEZyYW1lRGVsdGEgPSB0aGlzLmZyYW1lRGVsdGE7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZyYW1lRGVsdGEgPSAwO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9sZEZyYW1lRGVsdGE7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgfSwge1xuXHQgICAgICAgICAgICAgICAga2V5OiAnc3RhcnQnLFxuXHQgICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0YXJ0KCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJ1bm5pbmcgPSB0cnVlO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0RnJhbWVUaW1lTXMgPSB0aGlzLmdldFRpbWUoKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0RnBzVXBkYXRlID0gdGhpcy5nZXRUaW1lKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnJhbWVzVGhpc1NlY29uZCA9IDA7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAvLyAgVGhpcyBzdGFydHMgUkFGIGdvaW5nIGF1dG9tYXRpY2FsbHlcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yYWYuc3RhcnQoZnVuY3Rpb24gKG5vdykge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5zdGVwKG5vdyk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgIH0sIHtcblx0ICAgICAgICAgICAgICAgIGtleTogJ3N0ZXAnLFxuXHQgICAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0ZXAodGltZXN0YW1wKSB7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aW1lc3RhbXApO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAvLyBkZWJ1Z2dlcjtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRocm90dGxlIHRoZSBmcmFtZSByYXRlIChpZiBtaW5GcmFtZURlbGF5IGlzIHNldCB0byBhIG5vbi16ZXJvIHZhbHVlIGJ5XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIGBNYWluTG9vcC5zZXRNYXhBbGxvd2VkRlBTKClgKS5cblx0ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRpbWVzdGFtcCA8IHRoaXMubGFzdEZyYW1lVGltZU1zICsgdGhpcy5taW5GcmFtZURlbGF5KSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUnVuIHRoZSBsb29wIGFnYWluIHRoZSBuZXh0IHRpbWUgdGhlIGJyb3dzZXIgaXMgcmVhZHkgdG8gcmVuZGVyLlxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJhZkhhbmRsZSA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShhbmltYXRlKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZyYW1lRGVsdGEgaXMgdGhlIGN1bXVsYXRpdmUgYW1vdW50IG9mIGluLWFwcCB0aW1lIHRoYXQgaGFzbid0IGJlZW5cblx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2ltdWxhdGVkIHlldC4gQWRkIHRoZSB0aW1lIHNpbmNlIHRoZSBsYXN0IGZyYW1lLiBXZSBuZWVkIHRvIHRyYWNrIHRvdGFsXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vdC15ZXQtc2ltdWxhdGVkIHRpbWUgKGFzIG9wcG9zZWQgdG8ganVzdCB0aGUgdGltZSBlbGFwc2VkIHNpbmNlIHRoZVxuXHQgICAgICAgICAgICAgICAgICAgICAgICAvLyBsYXN0IGZyYW1lKSBiZWNhdXNlIG5vdCBhbGwgYWN0dWFsbHkgZWxhcHNlZCB0aW1lIGlzIGd1YXJhbnRlZWQgdG8gYmVcblx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2ltdWxhdGVkIGVhY2ggZnJhbWUuIFNlZSB0aGUgY29tbWVudHMgYmVsb3cgZm9yIGRldGFpbHMuXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnJhbWVEZWx0YSArPSB0aW1lc3RhbXAgLSB0aGlzLmxhc3RGcmFtZVRpbWVNcztcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXN0RnJhbWVUaW1lTXMgPSB0aW1lc3RhbXA7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAvLyBSdW4gYW55IHVwZGF0ZXMgdGhhdCBhcmUgbm90IGRlcGVuZGVudCBvbiB0aW1lIGluIHRoZSBzaW11bGF0aW9uLiBTZWVcblx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gYE1haW5Mb29wLnNldEJlZ2luKClgIGZvciBhZGRpdGlvbmFsIGRldGFpbHMgb24gaG93IHRvIHVzZSB0aGlzLlxuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJlZ2luKHRpbWVzdGFtcCwgdGhpcy5mcmFtZURlbHRhKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5iZWdpbih0aGlzLmZyYW1lRGVsdGEpO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSBlc3RpbWF0ZSBvZiB0aGUgZnJhbWUgcmF0ZSwgYGZwc2AuIEV2ZXJ5IHNlY29uZCwgdGhlIG51bWJlclxuXHQgICAgICAgICAgICAgICAgICAgICAgICAvLyBvZiBmcmFtZXMgdGhhdCBvY2N1cnJlZCBpbiB0aGF0IHNlY29uZCBhcmUgaW5jbHVkZWQgaW4gYW4gZXhwb25lbnRpYWxcblx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gbW92aW5nIGF2ZXJhZ2Ugb2YgYWxsIGZyYW1lcyBwZXIgc2Vjb25kLCB3aXRoIGFuIGFscGhhIG9mIDAuMjUuIFRoaXNcblx0ICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWVhbnMgdGhhdCBtb3JlIHJlY2VudCBzZWNvbmRzIGFmZmVjdCB0aGUgZXN0aW1hdGVkIGZyYW1lIHJhdGUgbW9yZSB0aGFuXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9sZGVyIHNlY29uZHMuXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aW1lc3RhbXAgPiB0aGlzLmxhc3RGcHNVcGRhdGUgKyAxMDAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29tcHV0ZSB0aGUgbmV3IGV4cG9uZW50aWFsIG1vdmluZyBhdmVyYWdlIHdpdGggYW4gYWxwaGEgb2YgMC4yNS5cblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBVc2luZyBjb25zdGFudHMgaW5saW5lIGlzIG9rYXkgaGVyZS5cblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZwcyA9IDAuMjUgKiB0aGlzLmZyYW1lc1RoaXNTZWNvbmQgKyAwLjc1ICogdGhpcy5mcHM7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdEZwc1VwZGF0ZSA9IHRpbWVzdGFtcDtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZyYW1lc1RoaXNTZWNvbmQgPSAwO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZyYW1lc1RoaXNTZWNvbmQrKztcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubnVtVXBkYXRlU3RlcHMgPSAwO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHRoaXMuZnJhbWVEZWx0YSA+PSB0aGlzLnRpbWVzdGVwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGUodGhpcy50aW1lc3RlcCk7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZnJhbWVEZWx0YSAtPSB0aGlzLnRpbWVzdGVwO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKyt0aGlzLm51bVVwZGF0ZVN0ZXBzID49IDI0MCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wYW5pYyA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZHJhdyh0aGlzLmZyYW1lRGVsdGEgLyB0aGlzLnRpbWVzdGVwKTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJ1biBhbnkgdXBkYXRlcyB0aGF0IGFyZSBub3QgZGVwZW5kZW50IG9uIHRpbWUgaW4gdGhlIHNpbXVsYXRpb24uIFNlZVxuXHQgICAgICAgICAgICAgICAgICAgICAgICAvLyBgTWFpbkxvb3Auc2V0RW5kKClgIGZvciBhZGRpdGlvbmFsIGRldGFpbHMgb24gaG93IHRvIHVzZSB0aGlzLlxuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZCh0aGlzLmZwcywgdGhpcy5wYW5pYyk7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBhbmljID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgfSwge1xuXHQgICAgICAgICAgICAgICAga2V5OiAnc3RvcCcsXG5cdCAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RvcCgpIHtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucnVubmluZyA9IGZhbHNlO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgPSBmYWxzZTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmFmLnN0b3AoKTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgIH0sIHtcblx0ICAgICAgICAgICAgICAgIGtleTogJ21heEZQUycsXG5cdCAgICAgICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxMDAwIC8gdGhpcy5taW5GcmFtZURlbGF5O1xuXHQgICAgICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICAgICAgIHNldDogZnVuY3Rpb24gc2V0KCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnBzID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8gSW5maW5pdHkgOiBhcmd1bWVudHNbMF07XG5cdFxuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZwcyA9PT0gMCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcCgpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWluRnJhbWVEZWxheSA9IDEwMDAgLyBmcHM7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICB9LCB7XG5cdCAgICAgICAgICAgICAgICBrZXk6ICdpc1J1bm5pbmcnLFxuXHQgICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5ydW5uaW5nO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgIH1dKTtcblx0XG5cdCAgICAgICAgcmV0dXJuIE1haW5Mb29wO1xuXHR9KCk7XG5cdFxuXHRleHBvcnRzLmRlZmF1bHQgPSBNYWluTG9vcDtcblxuLyoqKi8gfSxcblxuLyoqKi8gMTgzOlxuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0ZXhwb3J0cy5kZWZhdWx0ID0gUGFyc2VYTUw7XG5cdGZ1bmN0aW9uIFBhcnNlWE1MKGRhdGEpIHtcblx0XG5cdCAgICB2YXIgeG1sID0gJyc7XG5cdFxuXHQgICAgdHJ5IHtcblx0ICAgICAgICBpZiAod2luZG93WydET01QYXJzZXInXSkge1xuXHQgICAgICAgICAgICB2YXIgZG9tcGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xuXHQgICAgICAgICAgICB4bWwgPSBkb21wYXJzZXIucGFyc2VGcm9tU3RyaW5nKGRhdGEsICd0ZXh0L3htbCcpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHhtbCA9IG5ldyBBY3RpdmVYT2JqZWN0KCdNaWNyb3NvZnQuWE1MRE9NJyk7XG5cdCAgICAgICAgICAgIHhtbC5sb2FkWE1MKGRhdGEpO1xuXHQgICAgICAgIH1cblx0ICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgICB4bWwgPSBudWxsO1xuXHQgICAgfVxuXHRcblx0ICAgIGlmICgheG1sIHx8ICF4bWwuZG9jdW1lbnRFbGVtZW50IHx8IHhtbC5nZXRFbGVtZW50c0J5VGFnTmFtZSgncGFyc2VyZXJyb3InKS5sZW5ndGgpIHtcblx0ICAgICAgICByZXR1cm4gbnVsbDtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIHhtbDtcblx0ICAgIH1cblx0fVxuXG4vKioqLyB9LFxuXG4vKioqLyAyOTQ6XG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdHZhciBfU2lnbmFsQmluZGluZyA9IF9fd2VicGFja19yZXF1aXJlX18oMjk1KTtcblx0XG5cdHZhciBfU2lnbmFsQmluZGluZzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9TaWduYWxCaW5kaW5nKTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXHRcblx0dmFyIFNpZ25hbCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgIGZ1bmN0aW9uIFNpZ25hbCgpIHtcblx0ICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2lnbmFsKTtcblx0XG5cdCAgICAgICAgdGhpcy5jYWxsYmFja3MgPSBuZXcgTWFwKCk7XG5cdCAgICAgICAgdGhpcy5wcmV2UGFyYW1zID0gW107XG5cdCAgICAgICAgdGhpcy5tZW1vcml6ZSA9IGZhbHNlO1xuXHQgICAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcblx0ICAgICAgICB0aGlzLnByb3BhZ2F0ZSA9IHRydWU7XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKFNpZ25hbCwgW3tcblx0ICAgICAgICBrZXk6ICd2YWxpZGF0ZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHZhbGlkYXRlKGxpc3RlbmVyLCBpc09uY2UpIHtcblx0XG5cdCAgICAgICAgICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09ICdmdW5jdGlvbicpIHtcblx0ICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignU2lnbmFsLmFkZDogbGlzdGVuZXIgYXJndW1lbnQgaXMgcmVxdWlyZWQgYW5kIHNob3VsZCBiZSBhIEZ1bmN0aW9uLicpO1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAvLyAgQ2hlY2sgd2UgZG9uJ3QgaGF2ZSBhbnkgJ2lzT25jZScgU2lnbmFscyBhbHJlYWR5IGJvdW5kXG5cdCAgICAgICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTtcblx0ICAgICAgICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yID0gZmFsc2U7XG5cdCAgICAgICAgICAgIHZhciBfaXRlcmF0b3JFcnJvciA9IHVuZGVmaW5lZDtcblx0XG5cdCAgICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSB0aGlzLmNhbGxiYWNrcy5rZXlzKClbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gKF9zdGVwID0gX2l0ZXJhdG9yLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdmFyIGJpbmRpbmcgPSBfc3RlcC52YWx1ZTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKGJpbmRpbmcubGlzdGVuZXIgPT09IGxpc3RlbmVyKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaW5kaW5nLmlzT25jZSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdTaWduYWwuYWRkOiBZb3UgYWxyZWFkeSBoYXZlIHRoZSBnaXZlbiBsaXN0ZW5lciBib3VuZCBcXCdpc09uY2VcXCcgdG8gdGhpcyBTaWduYWwuJyk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNPbmNlKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1NpZ25hbC5hZGRPbmNlOiBZb3UgY2Fubm90IGFkZE9uY2UgYSBsaXN0ZW5lciB0aGF0IGlzIGFscmVhZHkgYm91bmQgdG8gdGhpcyBTaWduYWwuJyk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuXHQgICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IgPSBlcnI7XG5cdCAgICAgICAgICAgIH0gZmluYWxseSB7XG5cdCAgICAgICAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3IucmV0dXJuKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvci5yZXR1cm4oKTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuXHQgICAgICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcikge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdhZGQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGQobGlzdGVuZXIpIHtcblx0ICAgICAgICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG5cdCAgICAgICAgICAgICAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVnaXN0ZXIobGlzdGVuZXIsIGZhbHNlLCBhcmdzKTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnYWRkT25jZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZE9uY2UobGlzdGVuZXIpIHtcblx0ICAgICAgICAgICAgZm9yICh2YXIgX2xlbjIgPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gQXJyYXkoX2xlbjIgPiAxID8gX2xlbjIgLSAxIDogMCksIF9rZXkyID0gMTsgX2tleTIgPCBfbGVuMjsgX2tleTIrKykge1xuXHQgICAgICAgICAgICAgICAgYXJnc1tfa2V5MiAtIDFdID0gYXJndW1lbnRzW19rZXkyXTtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVnaXN0ZXIobGlzdGVuZXIsIHRydWUsIGFyZ3MpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdyZWdpc3RlcicsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyKGxpc3RlbmVyLCBpc09uY2UsIGFyZ3MpIHtcblx0XG5cdCAgICAgICAgICAgIGlmICghdGhpcy52YWxpZGF0ZShsaXN0ZW5lciwgZmFsc2UpKSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgdmFyIGJpbmRpbmcgPSBuZXcgX1NpZ25hbEJpbmRpbmcyLmRlZmF1bHQodGhpcywgbGlzdGVuZXIsIGZhbHNlLCBhcmdzKTtcblx0XG5cdCAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tzLnNldChiaW5kaW5nLCBsaXN0ZW5lcik7XG5cdFxuXHQgICAgICAgICAgICBpZiAodGhpcy5tZW1vcml6ZSAmJiB0aGlzLnByZXZQYXJhbXMubGVuZ3RoID4gMCkge1xuXHQgICAgICAgICAgICAgICAgYmluZGluZy5leGVjdXRlKHRoaXMucHJldlBhcmFtcyk7XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHJldHVybiBiaW5kaW5nO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdkaXNwYXRjaCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpc3BhdGNoKCkge1xuXHQgICAgICAgICAgICBmb3IgKHZhciBfbGVuMyA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBBcnJheShfbGVuMyksIF9rZXkzID0gMDsgX2tleTMgPCBfbGVuMzsgX2tleTMrKykge1xuXHQgICAgICAgICAgICAgICAgYXJnc1tfa2V5M10gPSBhcmd1bWVudHNbX2tleTNdO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICBpZiAodGhpcy5tZW1vcml6ZSkge1xuXHQgICAgICAgICAgICAgICAgdGhpcy5wcmV2UGFyYW1zID0gYXJncztcblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gdHJ1ZTtcblx0ICAgICAgICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMiA9IGZhbHNlO1xuXHQgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IyID0gdW5kZWZpbmVkO1xuXHRcblx0ICAgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSB0aGlzLmNhbGxiYWNrcy5rZXlzKClbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDI7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSAoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWUpIHtcblx0ICAgICAgICAgICAgICAgICAgICB2YXIgYmluZGluZyA9IF9zdGVwMi52YWx1ZTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRydWU7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgIGlmIChiaW5kaW5nLmFjdGl2ZSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBiaW5kaW5nLmV4ZWN1dGUoYXJncyk7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucHJvcGFnYXRlIHx8ICFyZXN1bHQpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG5cdCAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjIgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IyID0gZXJyO1xuXHQgICAgICAgICAgICB9IGZpbmFsbHkge1xuXHQgICAgICAgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yICYmIF9pdGVyYXRvcjIucmV0dXJuKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjIucmV0dXJuKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IyKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yMjtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAncmVtb3ZlJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlKGJpbmRpbmcpIHtcblx0XG5cdCAgICAgICAgICAgIGJpbmRpbmcuZGVzdHJveSgpO1xuXHRcblx0ICAgICAgICAgICAgdGhpcy5jYWxsYmFja3MuZGVsZXRlKGJpbmRpbmcpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdyZW1vdmVBbGwnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVBbGwoKSB7XG5cdCAgICAgICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IHRydWU7XG5cdCAgICAgICAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvcjMgPSBmYWxzZTtcblx0ICAgICAgICAgICAgdmFyIF9pdGVyYXRvckVycm9yMyA9IHVuZGVmaW5lZDtcblx0XG5cdCAgICAgICAgICAgIHRyeSB7XG5cdFxuXHQgICAgICAgICAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yMyA9IHRoaXMuY2FsbGJhY2tzLmtleXMoKVtTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwMzsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IChfc3RlcDMgPSBfaXRlcmF0b3IzLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zID0gdHJ1ZSkge1xuXHQgICAgICAgICAgICAgICAgICAgIHZhciBiaW5kaW5nID0gX3N0ZXAzLnZhbHVlO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICBiaW5kaW5nLmRlc3Ryb3koKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG5cdCAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjMgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IzID0gZXJyO1xuXHQgICAgICAgICAgICB9IGZpbmFsbHkge1xuXHQgICAgICAgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zICYmIF9pdGVyYXRvcjMucmV0dXJuKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvcjMucmV0dXJuKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IzKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yMztcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tzLmNsZWFyKCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2hhbHQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYWx0KCkge1xuXHRcblx0ICAgICAgICAgICAgdGhpcy5wcm9wYWdhdGUgPSBmYWxzZTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnaGFzJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGFzKGxpc3RlbmVyKSB7XG5cdCAgICAgICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCA9IHRydWU7XG5cdCAgICAgICAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvcjQgPSBmYWxzZTtcblx0ICAgICAgICAgICAgdmFyIF9pdGVyYXRvckVycm9yNCA9IHVuZGVmaW5lZDtcblx0XG5cdCAgICAgICAgICAgIHRyeSB7XG5cdFxuXHQgICAgICAgICAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yNCA9IHRoaXMuY2FsbGJhY2tzLmtleXMoKVtTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwNDsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uNCA9IChfc3RlcDQgPSBfaXRlcmF0b3I0Lm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb240ID0gdHJ1ZSkge1xuXHQgICAgICAgICAgICAgICAgICAgIHZhciBiaW5kaW5nID0gX3N0ZXA0LnZhbHVlO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICBpZiAoYmluZGluZy5saXN0ZW5lciA9PT0gbGlzdGVuZXIpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcblx0ICAgICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yNCA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvcjQgPSBlcnI7XG5cdCAgICAgICAgICAgIH0gZmluYWxseSB7XG5cdCAgICAgICAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjQgJiYgX2l0ZXJhdG9yNC5yZXR1cm4pIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yNC5yZXR1cm4oKTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuXHQgICAgICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjQpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I0O1xuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdmb3JnZXQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmb3JnZXQoKSB7XG5cdFxuXHQgICAgICAgICAgICB0aGlzLnByZXZQYXJhbXMgPSBbXTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnZ2V0TnVtTGlzdGVuZXJzJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TnVtTGlzdGVuZXJzKCkge1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FsbGJhY2tzLnNpemU7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuXHRcblx0ICAgICAgICAgICAgdGhpcy5yZW1vdmVBbGwoKTtcblx0ICAgICAgICAgICAgdGhpcy5mb3JnZXQoKTtcblx0XG5cdCAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tzID0gbnVsbDtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnaGFzTGlzdGVuZXJzJyxcblx0ICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzLmNhbGxiYWNrcy5zaXplID4gMDtcblx0ICAgICAgICB9XG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIFNpZ25hbDtcblx0fSgpO1xuXHRcblx0ZXhwb3J0cy5kZWZhdWx0ID0gU2lnbmFsO1xuXG4vKioqLyB9LFxuXG4vKioqLyAyOTU6XG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cdFxuXHR2YXIgU2lnbmFsQmluZGluZyA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBmdW5jdGlvbiBTaWduYWxCaW5kaW5nKHNpZ25hbCwgbGlzdGVuZXIpIHtcblx0ICAgICAgICAgICAgICAgIHZhciBpc09uY2UgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IGFyZ3VtZW50c1syXTtcblx0ICAgICAgICAgICAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzLmxlbmd0aCA8PSAzIHx8IGFyZ3VtZW50c1szXSA9PT0gdW5kZWZpbmVkID8gW10gOiBhcmd1bWVudHNbM107XG5cdFxuXHQgICAgICAgICAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNpZ25hbEJpbmRpbmcpO1xuXHRcblx0ICAgICAgICAgICAgICAgIHRoaXMuc2lnbmFsID0gc2lnbmFsO1xuXHRcblx0ICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuZXIgPSBsaXN0ZW5lcjtcblx0XG5cdCAgICAgICAgICAgICAgICB0aGlzLmlzT25jZSA9IGlzT25jZTtcblx0XG5cdCAgICAgICAgICAgICAgICB0aGlzLmFyZ3MgPSBhcmdzO1xuXHRcblx0ICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIF9jcmVhdGVDbGFzcyhTaWduYWxCaW5kaW5nLCBbe1xuXHQgICAgICAgICAgICAgICAga2V5OiBcImV4ZWN1dGVcIixcblx0ICAgICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBleGVjdXRlKGFyZ3MpIHtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmxpc3RlbmVyLmFwcGx5KG51bGwsIGFyZ3MuY29uY2F0KHRoaXMuYXJncykpO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNPbmNlKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zaWduYWwucmVtb3ZlKHRoaXMpO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgIH0sIHtcblx0ICAgICAgICAgICAgICAgIGtleTogXCJkZXN0cm95XCIsXG5cdCAgICAgICAgICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2lnbmFsID0gbnVsbDtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0ZW5lciA9IG51bGw7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXJncyA9IG51bGw7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgfV0pO1xuXHRcblx0ICAgICAgICByZXR1cm4gU2lnbmFsQmluZGluZztcblx0fSgpO1xuXHRcblx0ZXhwb3J0cy5kZWZhdWx0ID0gU2lnbmFsQmluZGluZztcblxuLyoqKi8gfSxcblxuLyoqKi8gNzcxOlxuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cdFxuXHR2YXIgX1NpZ25hbCA9IF9fd2VicGFja19yZXF1aXJlX18oMjk0KTtcblx0XG5cdHZhciBfU2lnbmFsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1NpZ25hbCk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdHZhciBFdmVudERpc3BhdGNoZXIgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBFdmVudERpc3BhdGNoZXIoKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEV2ZW50RGlzcGF0Y2hlcik7XG5cdCAgICB9XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKEV2ZW50RGlzcGF0Y2hlciwgW3tcblx0ICAgICAgICBrZXk6ICdhZGQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGQoZXZlbnQsIGNhbGxiYWNrKSB7fVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3JlbW92ZScsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZShldmVudCwgY2FsbGJhY2spIHt9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnZGlzcGF0Y2gnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwYXRjaCgpIHt9XG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIEV2ZW50RGlzcGF0Y2hlcjtcblx0fSgpO1xuXHRcblx0ZXhwb3J0cy5kZWZhdWx0ID0gRXZlbnREaXNwYXRjaGVyO1xuXG4vKioqLyB9LFxuXG4vKioqLyA3NzI6XG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRcblx0dmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblx0XG5cdHZhciBfU2lnbmFsID0gX193ZWJwYWNrX3JlcXVpcmVfXygyOTQpO1xuXHRcblx0dmFyIF9TaWduYWwyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfU2lnbmFsKTtcblx0XG5cdGZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cdFxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXHRcblx0Ly8gIEEgU2lnbmFsR3JvdXAgaXMgYSBjb2xsZWN0aW9uIG9mIFNpZ25hbHMuXG5cdC8vICBBIHNpbmdsZSBlbnRpdHkgY2FuIGxpc3RlbiB0byBhICdHcm91cCcgYW5kIHdpbGwgcmVjZWl2ZSBhbGwgU2lnbmFscyBiZWxvbmdpbmcgdG8gdGhhdCBHcm91cC5cblx0Ly8gIEEgc2lkZS1lZmZlY3Qgb2YgdGhpcyBpcyB0aGF0IHlvdSBjYW5ub3QgaGF2ZSB5b3VyIG93biBjdXN0b20gYXJndW1lbnRzIGluIHlvdXIgY2FsbGJhY2tzLlxuXHRcblx0dmFyIFNpZ25hbEdyb3VwID0gZnVuY3Rpb24gKCkge1xuXHQgICAgZnVuY3Rpb24gU2lnbmFsR3JvdXAoKSB7XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNpZ25hbEdyb3VwKTtcblx0XG5cdCAgICAgICAgdGhpcy5zaWduYWxzID0gbmV3IFNldCgpO1xuXHQgICAgfVxuXHRcblx0ICAgIF9jcmVhdGVDbGFzcyhTaWduYWxHcm91cCwgW3tcblx0ICAgICAgICBrZXk6ICdhZGQnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGQoKSB7XG5cdCAgICAgICAgICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gQXJyYXkoX2xlbiksIF9rZXkgPSAwOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG5cdCAgICAgICAgICAgICAgICBhcmdzW19rZXldID0gYXJndW1lbnRzW19rZXldO1xuXHQgICAgICAgICAgICB9XG5cdFxuXHQgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWU7XG5cdCAgICAgICAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlO1xuXHQgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IgPSB1bmRlZmluZWQ7XG5cdFxuXHQgICAgICAgICAgICB0cnkge1xuXHRcblx0ICAgICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvciA9IGFyZ3NbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gKF9zdGVwID0gX2l0ZXJhdG9yLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdmFyIGFyZyA9IF9zdGVwLnZhbHVlO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLnNpZ25hbHMuYWRkKGFyZyk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuXHQgICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IgPSBlcnI7XG5cdCAgICAgICAgICAgIH0gZmluYWxseSB7XG5cdCAgICAgICAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3IucmV0dXJuKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvci5yZXR1cm4oKTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuXHQgICAgICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcikge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIC8vICBNYXliZSBzaG91bGQgaW5jbHVkZSBhIGtleT8gT3RoZXJ3aXNlIHlvdXIgaGFuZGxlciB3aWxsIGhhdmUgYSB0b3VnaCB0aW1lIGtub3dpbmcgd2hpY2ggc2lnbmFsIGl0J3MgcmVzcG9uZGluZyB0by5cblx0XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnY3JlYXRlJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKCkge1xuXHRcblx0ICAgICAgICAgICAgdmFyIHNpZ25hbCA9IG5ldyBfU2lnbmFsMi5kZWZhdWx0KCk7XG5cdFxuXHQgICAgICAgICAgICB0aGlzLnNpZ25hbHMuYWRkKHNpZ25hbCk7XG5cdFxuXHQgICAgICAgICAgICByZXR1cm4gc2lnbmFsO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdyZW1vdmUnLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmUoc2lnbmFsKSB7XG5cdFxuXHQgICAgICAgICAgICB0aGlzLnNpZ25hbHMuZGVsZXRlKHNpZ25hbCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3JlbW92ZUFsbCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUFsbCgpIHtcblx0XG5cdCAgICAgICAgICAgIHRoaXMuc2lnbmFscy5jbGVhcigpO1xuXHQgICAgICAgIH1cblx0ICAgIH0sIHtcblx0ICAgICAgICBrZXk6ICdsaXN0ZW4nLFxuXHQgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsaXN0ZW4obGlzdGVuZXIpIHtcblx0ICAgICAgICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gdHJ1ZTtcblx0ICAgICAgICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMiA9IGZhbHNlO1xuXHQgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IyID0gdW5kZWZpbmVkO1xuXHRcblx0ICAgICAgICAgICAgdHJ5IHtcblx0XG5cdCAgICAgICAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IyID0gdGhpcy5zaWduYWxzW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXAyOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gKF9zdGVwMiA9IF9pdGVyYXRvcjIubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSB0cnVlKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdmFyIHNpZ25hbCA9IF9zdGVwMi52YWx1ZTtcblx0XG5cdCAgICAgICAgICAgICAgICAgICAgc2lnbmFsLmFkZChsaXN0ZW5lcik7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuXHQgICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IyID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yMiA9IGVycjtcblx0ICAgICAgICAgICAgfSBmaW5hbGx5IHtcblx0ICAgICAgICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiAmJiBfaXRlcmF0b3IyLnJldHVybikge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IyLnJldHVybigpO1xuXHQgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yMikge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjI7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgfV0pO1xuXHRcblx0ICAgIHJldHVybiBTaWduYWxHcm91cDtcblx0fSgpO1xuXHRcblx0ZXhwb3J0cy5kZWZhdWx0ID0gU2lnbmFsR3JvdXA7XG5cbi8qKiovIH1cblxuLyoqKioqKi8gfSlcbn0pO1xuO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHN5c3RlbS5qc1xuICoqLyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogd2VicGFjay9ib290c3RyYXAgMWI2ZjU4YTE3NzQ1MDgwZjAwMWFcbiAqKi8iLCJpbXBvcnQgRXZlbnREaXNwYXRjaGVyIGZyb20gJy4vRXZlbnREaXNwYXRjaGVyLmpzJztcclxuaW1wb3J0IE1haW5Mb29wIGZyb20gJy4vTWFpbkxvb3AuanMnO1xyXG5pbXBvcnQgTk9PUCBmcm9tICcuL05PT1AuanMnO1xyXG5pbXBvcnQgUGFyc2VYTUwgZnJvbSAnLi9QYXJzZVhNTC5qcyc7XHJcbmltcG9ydCBTaWduYWwgZnJvbSAnLi9TaWduYWwuanMnO1xyXG5pbXBvcnQgU2lnbmFsQmluZGluZyBmcm9tICcuL1NpZ25hbEJpbmRpbmcuanMnO1xyXG5pbXBvcnQgU2lnbmFsR3JvdXAgZnJvbSAnLi9TaWduYWxHcm91cC5qcyc7XHJcblxyXG5leHBvcnQge1xyXG4gICAgRXZlbnREaXNwYXRjaGVyLFxyXG4gICAgTWFpbkxvb3AsXHJcbiAgICBOT09QLFxyXG4gICAgUGFyc2VYTUwsXHJcbiAgICBTaWduYWwsXHJcbiAgICBTaWduYWxCaW5kaW5nLFxyXG4gICAgU2lnbmFsR3JvdXBcclxufTtcclxuXHJcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3N5c3RlbS9pbmRleC5qc1xuICoqLyIsImltcG9ydCBOT09QIGZyb20gJy4uL3N5c3RlbS9OT09QLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlcXVlc3RBbmltYXRpb25GcmFtZSB7XHJcblxyXG4gICAgY29uc3RydWN0b3IgKHJvb3QsIGZvcmNlU2V0VGltZU91dCA9IGZhbHNlKSB7XHJcblxyXG4gICAgICAgIHRoaXMucm9vdCA9IHJvb3Q7XHJcbiAgICAgICAgdGhpcy5mb3JjZVNldFRpbWVPdXQgPSBmb3JjZVNldFRpbWVPdXQ7XHJcblxyXG4gICAgICAgIC8vICBJZiB0aGVyZSdzIG5vIHdpbmRvdyBvYmplY3Qgb3IgUkFGIHRoZW4gd2UgaGF2ZSB0byB1c2UgU1QgYW55d2F5XHJcbiAgICAgICAgaWYgKCFmb3JjZVNldFRpbWVPdXQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLmZvcmNlU2V0VGltZU91dCA9ICF0aGlzLm5vcm1hbGl6ZVJhZigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fcnVubmluZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3RpbWVPdXRJRCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBOT09QO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAgVW5kZXIgU2V0VGltZW91dCB0aGUgY2FsbGJhY2sgbXVzdCByZXR1cm4gdGhlIG1zIHZhbHVlIG9mIHdoZW4gdG8gcnVuIHRoZSBuZXh0IHVwZGF0ZVxyXG4gICAgc3RhcnQgKGNhbGxiYWNrKSB7XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5fcnVubmluZylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuX3J1bm5pbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMudXNpbmdTZXRUaW1lb3V0KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90aW1lT3V0SUQgPSB0aGlzLnJvb3Quc2V0VGltZW91dChub3cgPT4gdGhpcy51cGRhdGVTZXRUaW1lb3V0KERhdGUubm93KCkpLCAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVPdXRJRCA9IHRoaXMucm9vdC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUobm93ID0+IHRoaXMudXBkYXRlUkFGKG5vdykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVSQUYgKG5vdykge1xyXG5cclxuICAgICAgICB0aGlzLl9jYWxsYmFjayhub3cpO1xyXG5cclxuICAgICAgICB0aGlzLl90aW1lT3V0SUQgPSB0aGlzLnJvb3QucmVxdWVzdEFuaW1hdGlvbkZyYW1lKG5vdyA9PiB0aGlzLnVwZGF0ZVJBRihub3cpKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlU2V0VGltZW91dCAobm93KSB7XHJcblxyXG4gICAgICAgIHRoaXMuX3RpbWVPdXRJRCA9IHRoaXMucm9vdC5zZXRUaW1lb3V0KG5vdyA9PiB0aGlzLnVwZGF0ZVNldFRpbWVvdXQoRGF0ZS5ub3coKSksIDApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzdG9wICgpIHtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX3J1bm5pbmcpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZiAodGhpcy51c2luZ1NldFRpbWVvdXQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucm9vdC5jbGVhclRpbWVvdXQodGhpcy5fdGltZU91dElEKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucm9vdC5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLl90aW1lT3V0SUQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9ydW5uaW5nID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBub3JtYWxpemVSYWYgKCkge1xyXG5cclxuICAgICAgICBpZiAodGhpcy5yb290LnJlcXVlc3RBbmltYXRpb25GcmFtZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBmb3IgKGxldCB2ZW5kb3Igb2YgWydtcycsICdtb3onLCAnd2Via2l0JywgJ28nXSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucm9vdFt2ZW5kb3JdICsgJ1JlcXVlc3RBbmltYXRpb25GcmFtZScpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290LnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHRoaXMucm9vdFt2ZW5kb3JdICsgJ1JlcXVlc3RBbmltYXRpb25GcmFtZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290LmNhbmNlbEFuaW1hdGlvbkZyYW1lID0gdGhpcy5yb290W3ZlbmRvcl0gKyAnQ2FuY2VsQW5pbWF0aW9uRnJhbWUnO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldCB1c2luZ1NldFRpbWVvdXQgKCkge1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5mb3JjZVNldFRpbWVPdXQ7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldCB1c2luZ1JBRiAoKSB7XHJcblxyXG4gICAgICAgIHJldHVybiAhdGhpcy5mb3JjZVNldFRpbWVPdXQ7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldCBpc1J1bm5pbmcgKCkge1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5fcnVubmluZztcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGlzUnVubmluZyAodmFsdWUpIHtcclxuXHJcbiAgICAgICAgaWYgKHZhbHVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5zdGFydCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxufVxyXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9kb20vUmVxdWVzdEFuaW1hdGlvbkZyYW1lLmpzXG4gKiovIiwiLy8gSW4gYWxsIG1ham9yIGJyb3dzZXJzLCByZXBsYWNpbmcgbm9uLXNwZWNpZmllZCBmdW5jdGlvbnMgd2l0aCBOT09Qc1xyXG4vLyBzZWVtcyB0byBiZSBhcyBmYXN0IG9yIHNsaWdodGx5IGZhc3RlciB0aGFuIHVzaW5nIGNvbmRpdGlvbnMgdG8gb25seVxyXG4vLyBjYWxsIHRoZSBmdW5jdGlvbnMgaWYgdGhleSBhcmUgc3BlY2lmaWVkLiBUaGlzIGlzIHByb2JhYmx5IGR1ZSB0byBlbXB0eVxyXG4vLyBmdW5jdGlvbnMgYmVpbmcgb3B0aW1pemVkIGF3YXkuIGh0dHA6Ly9qc3BlcmYuY29tL25vb3AtdnMtY29uZGl0aW9uXHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBOT09QICgpIHtcclxuXHJcbiAgICAvLyAgVGhhdCdzIHJpZ2h0LCB0aGVyZSdzIG5vdGhpbmcgaGVyZS5cclxuICAgIFxyXG59XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvc3lzdGVtL05PT1AuanNcbiAqKi8iLCJpbXBvcnQgUmVxdWVzdEFuaW1hdGlvbkZyYW1lIGZyb20gJy4uL2RvbS9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUuanMnO1xyXG5pbXBvcnQgTk9PUCBmcm9tICcuL05PT1AuanMnO1xyXG5cclxuLy8gIE15IHRoYW5rcyB0byBJc2FhYyBTdWtpbiBmb3Igc29tZSBvZiB0aGUgY29uY2VwdHMgdXNlZCBpbiB0aGlzIGNsYXNzXHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNYWluTG9vcCB7XHJcblxyXG4gICAgY29uc3RydWN0b3IgKGZyYW1lcmF0ZSA9IDYwKSB7XHJcblxyXG4gICAgICAgIC8vICBNb3ZlIHRvIGV4dGVybmFsIGZpbGUgb25jZSB0ZXN0ZWRcclxuICAgICAgICB0aGlzLmdldFRpbWUgPSBEYXRlLm5vdztcclxuXHJcbiAgICAgICAgaWYgKHdpbmRvdy5wZXJmb3JtYW5jZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGlmICh3aW5kb3cucGVyZm9ybWFuY2Uubm93KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFRpbWUgPSAoKSA9PiB7IHJldHVybiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCkgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh3aW5kb3cucGVyZm9ybWFuY2Uud2Via2l0Tm93KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdldFRpbWUgPSAoKSA9PiB7IHJldHVybiB3aW5kb3cucGVyZm9ybWFuY2Uud2Via2l0Tm93KCkgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy50aW1lc3RlcCA9IDEwMDAgLyBmcmFtZXJhdGU7XHJcbiAgICAgICAgdGhpcy5waHlzaWNzU3RlcCA9IDEgLyBmcmFtZXJhdGU7XHJcblxyXG4gICAgLy8gVGhlIGN1bXVsYXRpdmUgYW1vdW50IG9mIGluLWFwcCB0aW1lIHRoYXQgaGFzbid0IGJlZW4gc2ltdWxhdGVkIHlldC5cclxuICAgIC8vIFNlZSB0aGUgY29tbWVudHMgaW5zaWRlIGFuaW1hdGUoKSBmb3IgZGV0YWlscy5cclxuICAgICAgICB0aGlzLmZyYW1lRGVsdGEgPSAwO1xyXG5cclxuICAgIC8vIFRoZSB0aW1lc3RhbXAgaW4gbWlsbGlzZWNvbmRzIG9mIHRoZSBsYXN0IHRpbWUgdGhlIG1haW4gbG9vcCB3YXMgcnVuLlxyXG4gICAgLy8gVXNlZCB0byBjb21wdXRlIHRoZSB0aW1lIGVsYXBzZWQgYmV0d2VlbiBmcmFtZXMuXHJcbiAgICAgICAgdGhpcy5sYXN0RnJhbWVUaW1lTXMgPSAwO1xyXG5cclxuICAgIC8vIEFuIGV4cG9uZW50aWFsIG1vdmluZyBhdmVyYWdlIG9mIHRoZSBmcmFtZXMgcGVyIHNlY29uZC5cclxuICAgICAgICB0aGlzLmZwcyA9IDYwO1xyXG5cclxuICAgIC8vIFRoZSB0aW1lc3RhbXAgKGluIG1pbGxpc2Vjb25kcykgb2YgdGhlIGxhc3QgdGltZSB0aGUgYGZwc2AgbW92aW5nXHJcbiAgICAvLyBhdmVyYWdlIHdhcyB1cGRhdGVkLlxyXG4gICAgICAgIHRoaXMubGFzdEZwc1VwZGF0ZSA9IDA7XHJcblxyXG4gICAgLy8gVGhlIG51bWJlciBvZiBmcmFtZXMgZGVsaXZlcmVkIGluIHRoZSBjdXJyZW50IHNlY29uZC5cclxuICAgICAgICB0aGlzLmZyYW1lc1RoaXNTZWNvbmQgPSAwO1xyXG5cclxuICAgIC8vIFRoZSBudW1iZXIgb2YgdGltZXMgdXBkYXRlKCkgaXMgY2FsbGVkIGluIGEgZ2l2ZW4gZnJhbWUuIFRoaXMgaXMgb25seVxyXG4gICAgLy8gcmVsZXZhbnQgaW5zaWRlIG9mIGFuaW1hdGUoKSwgYnV0IGEgcmVmZXJlbmNlIGlzIGhlbGQgZXh0ZXJuYWxseSBzbyB0aGF0XHJcbiAgICAvLyB0aGlzIHZhcmlhYmxlIGlzIG5vdCBtYXJrZWQgZm9yIGdhcmJhZ2UgY29sbGVjdGlvbiBldmVyeSB0aW1lIHRoZSBtYWluXHJcbiAgICAvLyBsb29wIHJ1bnMuXHJcbiAgICAgICAgdGhpcy5udW1VcGRhdGVTdGVwcyA9IDA7XHJcblxyXG4gICAgLy8gVGhlIG1pbmltdW0gYW1vdW50IG9mIHRpbWUgaW4gbWlsbGlzZWNvbmRzIHRoYXQgbXVzdCBwYXNzIHNpbmNlIHRoZSBsYXN0XHJcbiAgICAvLyBmcmFtZSB3YXMgZXhlY3V0ZWQgYmVmb3JlIGFub3RoZXIgZnJhbWUgY2FuIGJlIGV4ZWN1dGVkLiBUaGVcclxuICAgIC8vIG11bHRpcGxpY2F0aXZlIGludmVyc2UgY2FwcyB0aGUgRlBTICh0aGUgZGVmYXVsdCBvZiB6ZXJvIG1lYW5zIHRoZXJlIGlzXHJcbiAgICAvLyBubyBjYXApLlxyXG4gICAgICAgIHRoaXMubWluRnJhbWVEZWxheSA9IDA7XHJcblxyXG4gICAgLy8gV2hldGhlciB0aGUgbWFpbiBsb29wIGlzIHJ1bm5pbmcuXHJcbiAgICAgICAgdGhpcy5ydW5uaW5nID0gZmFsc2U7XHJcblxyXG4gICAgLy8gYHRydWVgIGlmIGBNYWluTG9vcC5zdGFydCgpYCBoYXMgYmVlbiBjYWxsZWQgYW5kIHRoZSBtb3N0IHJlY2VudCB0aW1lIGl0XHJcbiAgICAvLyB3YXMgY2FsbGVkIGhhcyBub3QgYmVlbiBmb2xsb3dlZCBieSBhIGNhbGwgdG8gYE1haW5Mb29wLnN0b3AoKWAuIFRoaXMgaXNcclxuICAgIC8vIGRpZmZlcmVudCB0aGFuIGBydW5uaW5nYCBiZWNhdXNlIHRoZXJlIGlzIGEgZGVsYXkgb2YgYSBmZXcgbWlsbGlzZWNvbmRzXHJcbiAgICAvLyBhZnRlciBgTWFpbkxvb3Auc3RhcnQoKWAgaXMgY2FsbGVkIGJlZm9yZSB0aGUgYXBwbGljYXRpb24gaXMgY29uc2lkZXJlZFxyXG4gICAgLy8gXCJydW5uaW5nLlwiIFRoaXMgZGVsYXkgaXMgZHVlIHRvIHdhaXRpbmcgZm9yIHRoZSBuZXh0IGZyYW1lLlxyXG4gICAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xyXG5cclxuICAgIC8vIFdoZXRoZXIgdGhlIHNpbXVsYXRpb24gaGFzIGZhbGxlbiB0b28gZmFyIGJlaGluZCByZWFsIHRpbWUuXHJcbiAgICAvLyBTcGVjaWZpY2FsbHksIGBwYW5pY2Agd2lsbCBiZSBzZXQgdG8gYHRydWVgIGlmIHRvbyBtYW55IHVwZGF0ZXMgb2NjdXIgaW5cclxuICAgIC8vIG9uZSBmcmFtZS4gVGhpcyBpcyBvbmx5IHJlbGV2YW50IGluc2lkZSBvZiBhbmltYXRlKCksIGJ1dCBhIHJlZmVyZW5jZSBpc1xyXG4gICAgLy8gaGVsZCBleHRlcm5hbGx5IHNvIHRoYXQgdGhpcyB2YXJpYWJsZSBpcyBub3QgbWFya2VkIGZvciBnYXJiYWdlXHJcbiAgICAvLyBjb2xsZWN0aW9uIGV2ZXJ5IHRpbWUgdGhlIG1haW4gbG9vcCBydW5zLlxyXG4gICAgICAgIHRoaXMucGFuaWMgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgLy8gQSBmdW5jdGlvbiB0aGF0IHJ1bnMgYXQgdGhlIGJlZ2lubmluZyBvZiB0aGUgbWFpbiBsb29wLlxyXG4gICAgICAgIC8vIFNlZSBgTWFpbkxvb3Auc2V0QmVnaW4oKWAgZm9yIGRldGFpbHMuXHJcbiAgICAgICAgdGhpcy5iZWdpbiA9IE5PT1A7XHJcblxyXG4gICAgICAgIC8vIEEgZnVuY3Rpb24gdGhhdCBydW5zIHVwZGF0ZXMgKGkuZS4gQUkgYW5kIHBoeXNpY3MpLlxyXG4gICAgICAgIC8vIFNlZSBgTWFpbkxvb3Auc2V0VXBkYXRlKClgIGZvciBkZXRhaWxzLlxyXG4gICAgICAgIHRoaXMudXBkYXRlID0gTk9PUDtcclxuXHJcbiAgICAgICAgLy8gQSBmdW5jdGlvbiB0aGF0IGRyYXdzIHRoaW5ncyBvbiB0aGUgc2NyZWVuLlxyXG4gICAgICAgIC8vIFNlZSBgTWFpbkxvb3Auc2V0RHJhdygpYCBmb3IgZGV0YWlscy5cclxuICAgICAgICB0aGlzLmRyYXcgPSBOT09QO1xyXG5cclxuICAgICAgICAvLyBBIGZ1bmN0aW9uIHRoYXQgcnVucyBhdCB0aGUgZW5kIG9mIHRoZSBtYWluIGxvb3AuXHJcbiAgICAgICAgLy8gU2VlIGBNYWluTG9vcC5zZXRFbmQoKWAgZm9yIGRldGFpbHMuXHJcbiAgICAgICAgdGhpcy5lbmQgPSBOT09QO1xyXG5cclxuICAgICAgICB0aGlzLnJhZiA9IG5ldyBSZXF1ZXN0QW5pbWF0aW9uRnJhbWUod2luZG93LCBmYWxzZSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldCBtYXhGUFMgKCkge1xyXG5cclxuICAgICAgICByZXR1cm4gMTAwMCAvIHRoaXMubWluRnJhbWVEZWxheTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0IG1heEZQUyAoZnBzID0gSW5maW5pdHkpIHtcclxuXHJcbiAgICAgICAgaWYgKGZwcyA9PT0gMClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RvcCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLm1pbkZyYW1lRGVsYXkgPSAxMDAwIC8gZnBzO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmVzZXRGcmFtZURlbHRhICgpIHtcclxuXHJcbiAgICAgICAgbGV0IG9sZEZyYW1lRGVsdGEgPSB0aGlzLmZyYW1lRGVsdGE7XHJcblxyXG4gICAgICAgIHRoaXMuZnJhbWVEZWx0YSA9IDA7XHJcblxyXG4gICAgICAgIHJldHVybiBvbGRGcmFtZURlbHRhO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzdGFydCAoKSB7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc3RhcnRlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5ydW5uaW5nID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy5sYXN0RnJhbWVUaW1lTXMgPSB0aGlzLmdldFRpbWUoKTtcclxuICAgICAgICB0aGlzLmxhc3RGcHNVcGRhdGUgPSB0aGlzLmdldFRpbWUoKTtcclxuICAgICAgICB0aGlzLmZyYW1lc1RoaXNTZWNvbmQgPSAwO1xyXG5cclxuICAgICAgICAvLyAgVGhpcyBzdGFydHMgUkFGIGdvaW5nIGF1dG9tYXRpY2FsbHlcclxuICAgICAgICB0aGlzLnJhZi5zdGFydChub3cgPT4gdGhpcy5zdGVwKG5vdykpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzdGVwICh0aW1lc3RhbXApIHtcclxuXHJcbiAgICAgICAgLy8gY29uc29sZS5sb2codGltZXN0YW1wKTtcclxuICAgICAgICAvLyBkZWJ1Z2dlcjtcclxuXHJcbiAgICAgICAgLy8gVGhyb3R0bGUgdGhlIGZyYW1lIHJhdGUgKGlmIG1pbkZyYW1lRGVsYXkgaXMgc2V0IHRvIGEgbm9uLXplcm8gdmFsdWUgYnlcclxuICAgICAgICAvLyBgTWFpbkxvb3Auc2V0TWF4QWxsb3dlZEZQUygpYCkuXHJcbiAgICAgICAgaWYgKHRpbWVzdGFtcCA8IHRoaXMubGFzdEZyYW1lVGltZU1zICsgdGhpcy5taW5GcmFtZURlbGF5KVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgLy8gUnVuIHRoZSBsb29wIGFnYWluIHRoZSBuZXh0IHRpbWUgdGhlIGJyb3dzZXIgaXMgcmVhZHkgdG8gcmVuZGVyLlxyXG4gICAgICAgICAgICAvLyByYWZIYW5kbGUgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYW5pbWF0ZSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGZyYW1lRGVsdGEgaXMgdGhlIGN1bXVsYXRpdmUgYW1vdW50IG9mIGluLWFwcCB0aW1lIHRoYXQgaGFzbid0IGJlZW5cclxuICAgICAgICAvLyBzaW11bGF0ZWQgeWV0LiBBZGQgdGhlIHRpbWUgc2luY2UgdGhlIGxhc3QgZnJhbWUuIFdlIG5lZWQgdG8gdHJhY2sgdG90YWxcclxuICAgICAgICAvLyBub3QteWV0LXNpbXVsYXRlZCB0aW1lIChhcyBvcHBvc2VkIHRvIGp1c3QgdGhlIHRpbWUgZWxhcHNlZCBzaW5jZSB0aGVcclxuICAgICAgICAvLyBsYXN0IGZyYW1lKSBiZWNhdXNlIG5vdCBhbGwgYWN0dWFsbHkgZWxhcHNlZCB0aW1lIGlzIGd1YXJhbnRlZWQgdG8gYmVcclxuICAgICAgICAvLyBzaW11bGF0ZWQgZWFjaCBmcmFtZS4gU2VlIHRoZSBjb21tZW50cyBiZWxvdyBmb3IgZGV0YWlscy5cclxuICAgICAgICB0aGlzLmZyYW1lRGVsdGEgKz0gdGltZXN0YW1wIC0gdGhpcy5sYXN0RnJhbWVUaW1lTXM7XHJcbiAgICAgICAgdGhpcy5sYXN0RnJhbWVUaW1lTXMgPSB0aW1lc3RhbXA7XHJcblxyXG4gICAgICAgIC8vIFJ1biBhbnkgdXBkYXRlcyB0aGF0IGFyZSBub3QgZGVwZW5kZW50IG9uIHRpbWUgaW4gdGhlIHNpbXVsYXRpb24uIFNlZVxyXG4gICAgICAgIC8vIGBNYWluTG9vcC5zZXRCZWdpbigpYCBmb3IgYWRkaXRpb25hbCBkZXRhaWxzIG9uIGhvdyB0byB1c2UgdGhpcy5cclxuICAgICAgICB0aGlzLmJlZ2luKHRpbWVzdGFtcCwgdGhpcy5mcmFtZURlbHRhKTtcclxuICAgICAgICAvLyB0aGlzLmJlZ2luKHRoaXMuZnJhbWVEZWx0YSk7XHJcblxyXG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgZXN0aW1hdGUgb2YgdGhlIGZyYW1lIHJhdGUsIGBmcHNgLiBFdmVyeSBzZWNvbmQsIHRoZSBudW1iZXJcclxuICAgICAgICAvLyBvZiBmcmFtZXMgdGhhdCBvY2N1cnJlZCBpbiB0aGF0IHNlY29uZCBhcmUgaW5jbHVkZWQgaW4gYW4gZXhwb25lbnRpYWxcclxuICAgICAgICAvLyBtb3ZpbmcgYXZlcmFnZSBvZiBhbGwgZnJhbWVzIHBlciBzZWNvbmQsIHdpdGggYW4gYWxwaGEgb2YgMC4yNS4gVGhpc1xyXG4gICAgICAgIC8vIG1lYW5zIHRoYXQgbW9yZSByZWNlbnQgc2Vjb25kcyBhZmZlY3QgdGhlIGVzdGltYXRlZCBmcmFtZSByYXRlIG1vcmUgdGhhblxyXG4gICAgICAgIC8vIG9sZGVyIHNlY29uZHMuXHJcbiAgICAgICAgaWYgKHRpbWVzdGFtcCA+IHRoaXMubGFzdEZwc1VwZGF0ZSArIDEwMDApXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAvLyBDb21wdXRlIHRoZSBuZXcgZXhwb25lbnRpYWwgbW92aW5nIGF2ZXJhZ2Ugd2l0aCBhbiBhbHBoYSBvZiAwLjI1LlxyXG4gICAgICAgICAgICAvLyBVc2luZyBjb25zdGFudHMgaW5saW5lIGlzIG9rYXkgaGVyZS5cclxuICAgICAgICAgICAgdGhpcy5mcHMgPSAwLjI1ICogdGhpcy5mcmFtZXNUaGlzU2Vjb25kICsgMC43NSAqIHRoaXMuZnBzO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5sYXN0RnBzVXBkYXRlID0gdGltZXN0YW1wO1xyXG4gICAgICAgICAgICB0aGlzLmZyYW1lc1RoaXNTZWNvbmQgPSAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5mcmFtZXNUaGlzU2Vjb25kKys7XHJcblxyXG4gICAgICAgIHRoaXMubnVtVXBkYXRlU3RlcHMgPSAwO1xyXG5cclxuICAgICAgICB3aGlsZSAodGhpcy5mcmFtZURlbHRhID49IHRoaXMudGltZXN0ZXApXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZSh0aGlzLnRpbWVzdGVwKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZnJhbWVEZWx0YSAtPSB0aGlzLnRpbWVzdGVwO1xyXG5cclxuICAgICAgICAgICAgaWYgKCsrdGhpcy5udW1VcGRhdGVTdGVwcyA+PSAyNDApXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFuaWMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZHJhdyh0aGlzLmZyYW1lRGVsdGEgLyB0aGlzLnRpbWVzdGVwKTtcclxuXHJcbiAgICAgICAgLy8gUnVuIGFueSB1cGRhdGVzIHRoYXQgYXJlIG5vdCBkZXBlbmRlbnQgb24gdGltZSBpbiB0aGUgc2ltdWxhdGlvbi4gU2VlXHJcbiAgICAgICAgLy8gYE1haW5Mb29wLnNldEVuZCgpYCBmb3IgYWRkaXRpb25hbCBkZXRhaWxzIG9uIGhvdyB0byB1c2UgdGhpcy5cclxuICAgICAgICB0aGlzLmVuZCh0aGlzLmZwcywgdGhpcy5wYW5pYyk7XHJcblxyXG4gICAgICAgIHRoaXMucGFuaWMgPSBmYWxzZTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc3RvcCAoKSB7XHJcblxyXG4gICAgICAgIHRoaXMucnVubmluZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc3RhcnRlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLnJhZi5zdG9wKCk7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBnZXQgaXNSdW5uaW5nICgpIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMucnVubmluZztcclxuXHJcbiAgICB9XHJcbiAgICBcclxufVxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3N5c3RlbS9NYWluTG9vcC5qc1xuICoqLyIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIFBhcnNlWE1MIChkYXRhKSB7XHJcblxyXG4gICAgbGV0IHhtbCA9ICcnO1xyXG5cclxuICAgIHRyeVxyXG4gICAge1xyXG4gICAgICAgIGlmICh3aW5kb3dbJ0RPTVBhcnNlciddKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdmFyIGRvbXBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcclxuICAgICAgICAgICAgeG1sID0gZG9tcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhkYXRhLCAndGV4dC94bWwnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgeG1sID0gbmV3IEFjdGl2ZVhPYmplY3QoJ01pY3Jvc29mdC5YTUxET00nKTtcclxuICAgICAgICAgICAgeG1sLmxvYWRYTUwoZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpXHJcbiAgICB7XHJcbiAgICAgICAgeG1sID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIXhtbCB8fCAheG1sLmRvY3VtZW50RWxlbWVudCB8fCB4bWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3BhcnNlcmVycm9yJykubGVuZ3RoKVxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG4gICAgZWxzZVxyXG4gICAge1xyXG4gICAgICAgIHJldHVybiB4bWw7XHJcbiAgICB9XHJcblxyXG59XHJcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL3N5c3RlbS9QYXJzZVhNTC5qc1xuICoqLyIsImltcG9ydCBTaWduYWxCaW5kaW5nIGZyb20gJy4vU2lnbmFsQmluZGluZy5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTaWduYWwge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5jYWxsYmFja3MgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgdGhpcy5wcmV2UGFyYW1zID0gW107XHJcbiAgICAgICAgdGhpcy5tZW1vcml6ZSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLnByb3BhZ2F0ZSA9IHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHZhbGlkYXRlIChsaXN0ZW5lciwgaXNPbmNlKSB7XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgbGlzdGVuZXIgIT09ICdmdW5jdGlvbicpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ1NpZ25hbC5hZGQ6IGxpc3RlbmVyIGFyZ3VtZW50IGlzIHJlcXVpcmVkIGFuZCBzaG91bGQgYmUgYSBGdW5jdGlvbi4nKTtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gIENoZWNrIHdlIGRvbid0IGhhdmUgYW55ICdpc09uY2UnIFNpZ25hbHMgYWxyZWFkeSBib3VuZFxyXG4gICAgICAgIGZvciAobGV0IGJpbmRpbmcgb2YgdGhpcy5jYWxsYmFja3Mua2V5cygpKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYgKGJpbmRpbmcubGlzdGVuZXIgPT09IGxpc3RlbmVyKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZiAoYmluZGluZy5pc09uY2UpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdTaWduYWwuYWRkOiBZb3UgYWxyZWFkeSBoYXZlIHRoZSBnaXZlbiBsaXN0ZW5lciBib3VuZCBcXCdpc09uY2VcXCcgdG8gdGhpcyBTaWduYWwuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoaXNPbmNlKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignU2lnbmFsLmFkZE9uY2U6IFlvdSBjYW5ub3QgYWRkT25jZSBhIGxpc3RlbmVyIHRoYXQgaXMgYWxyZWFkeSBib3VuZCB0byB0aGlzIFNpZ25hbC4nKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBhZGQgKGxpc3RlbmVyLCAuLi5hcmdzKSB7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLnJlZ2lzdGVyKGxpc3RlbmVyLCBmYWxzZSwgYXJncyk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGFkZE9uY2UgKGxpc3RlbmVyLCAuLi5hcmdzKSB7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLnJlZ2lzdGVyKGxpc3RlbmVyLCB0cnVlLCBhcmdzKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmVnaXN0ZXIgKGxpc3RlbmVyLCBpc09uY2UsIGFyZ3MpIHtcclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLnZhbGlkYXRlKGxpc3RlbmVyLCBmYWxzZSkpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBiaW5kaW5nID0gbmV3IFNpZ25hbEJpbmRpbmcodGhpcywgbGlzdGVuZXIsIGZhbHNlLCBhcmdzKTtcclxuXHJcbiAgICAgICAgdGhpcy5jYWxsYmFja3Muc2V0KGJpbmRpbmcsIGxpc3RlbmVyKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMubWVtb3JpemUgJiYgdGhpcy5wcmV2UGFyYW1zLmxlbmd0aCA+IDApXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nLmV4ZWN1dGUodGhpcy5wcmV2UGFyYW1zKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBiaW5kaW5nO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBkaXNwYXRjaCAoLi4uYXJncykge1xyXG5cclxuICAgICAgICBpZiAodGhpcy5tZW1vcml6ZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMucHJldlBhcmFtcyA9IGFyZ3M7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBiaW5kaW5nIG9mIHRoaXMuY2FsbGJhY2tzLmtleXMoKSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgaWYgKGJpbmRpbmcuYWN0aXZlKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBiaW5kaW5nLmV4ZWN1dGUoYXJncyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghdGhpcy5wcm9wYWdhdGUgfHwgIXJlc3VsdClcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICByZW1vdmUgKGJpbmRpbmcpIHtcclxuXHJcbiAgICAgICAgYmluZGluZy5kZXN0cm95KCk7XHJcblxyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tzLmRlbGV0ZShiaW5kaW5nKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQWxsICgpIHtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgYmluZGluZyBvZiB0aGlzLmNhbGxiYWNrcy5rZXlzKCkpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nLmRlc3Ryb3koKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tzLmNsZWFyKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGhhbHQgKCkge1xyXG5cclxuICAgICAgICB0aGlzLnByb3BhZ2F0ZSA9IGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBoYXMgKGxpc3RlbmVyKSB7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGJpbmRpbmcgb2YgdGhpcy5jYWxsYmFja3Mua2V5cygpKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaWYgKGJpbmRpbmcubGlzdGVuZXIgPT09IGxpc3RlbmVyKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBmb3JnZXQgKCkge1xyXG5cclxuICAgICAgICB0aGlzLnByZXZQYXJhbXMgPSBbXTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGhhc0xpc3RlbmVycyAoKSB7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLmNhbGxiYWNrcy5zaXplID4gMDtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0TnVtTGlzdGVuZXJzICgpIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FsbGJhY2tzLnNpemU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGRlc3Ryb3kgKCkge1xyXG5cclxuICAgICAgICB0aGlzLnJlbW92ZUFsbCgpO1xyXG4gICAgICAgIHRoaXMuZm9yZ2V0KCk7XHJcblxyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tzID0gbnVsbDtcclxuXHJcbiAgICB9XHJcblxyXG59XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvc3lzdGVtL1NpZ25hbC5qc1xuICoqLyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNpZ25hbEJpbmRpbmcge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yIChzaWduYWwsIGxpc3RlbmVyLCBpc09uY2UgPSBmYWxzZSwgYXJncyA9IFtdKSB7XHJcblxyXG4gICAgICAgIHRoaXMuc2lnbmFsID0gc2lnbmFsO1xyXG5cclxuICAgICAgICB0aGlzLmxpc3RlbmVyID0gbGlzdGVuZXI7XHJcblxyXG4gICAgICAgIHRoaXMuaXNPbmNlID0gaXNPbmNlO1xyXG5cclxuICAgICAgICB0aGlzLmFyZ3MgPSBhcmdzO1xyXG5cclxuICAgICAgICB0aGlzLmFjdGl2ZSA9IHRydWU7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGV4ZWN1dGUgKGFyZ3MpIHtcclxuXHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IHRoaXMubGlzdGVuZXIuYXBwbHkobnVsbCwgYXJncy5jb25jYXQodGhpcy5hcmdzKSk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmlzT25jZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuc2lnbmFsLnJlbW92ZSh0aGlzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGRlc3Ryb3kgKCkge1xyXG5cclxuICAgICAgICB0aGlzLnNpZ25hbCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5saXN0ZW5lciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5hcmdzID0gbnVsbDtcclxuICAgICAgICB0aGlzLmFjdGl2ZSA9IGZhbHNlO1xyXG5cclxuICAgIH1cclxuXHJcbn1cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9zeXN0ZW0vU2lnbmFsQmluZGluZy5qc1xuICoqLyIsImltcG9ydCBTaWduYWwgZnJvbSAnLi4vc3lzdGVtL1NpZ25hbC5qcyc7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFdmVudERpc3BhdGNoZXIge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yICgpIHtcclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIGFkZCAoZXZlbnQsIGNhbGxiYWNrKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZSAoZXZlbnQsIGNhbGxiYWNrKSB7XHJcblxyXG5cclxuICAgIH1cclxuXHJcbiAgICBkaXNwYXRjaCAoLi4uYXJncykge1xyXG5cclxuICAgIH1cclxuXHJcbn1cclxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvc3lzdGVtL0V2ZW50RGlzcGF0Y2hlci5qc1xuICoqLyIsImltcG9ydCBTaWduYWwgZnJvbSAnLi9TaWduYWwuanMnO1xyXG5cclxuLy8gIEEgU2lnbmFsR3JvdXAgaXMgYSBjb2xsZWN0aW9uIG9mIFNpZ25hbHMuXHJcbi8vICBBIHNpbmdsZSBlbnRpdHkgY2FuIGxpc3RlbiB0byBhICdHcm91cCcgYW5kIHdpbGwgcmVjZWl2ZSBhbGwgU2lnbmFscyBiZWxvbmdpbmcgdG8gdGhhdCBHcm91cC5cclxuLy8gIEEgc2lkZS1lZmZlY3Qgb2YgdGhpcyBpcyB0aGF0IHlvdSBjYW5ub3QgaGF2ZSB5b3VyIG93biBjdXN0b20gYXJndW1lbnRzIGluIHlvdXIgY2FsbGJhY2tzLlxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2lnbmFsR3JvdXAge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5zaWduYWxzID0gbmV3IFNldCgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBhZGQgKC4uLmFyZ3MpIHtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgYXJnIG9mIGFyZ3MpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLnNpZ25hbHMuYWRkKGFyZyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAgTWF5YmUgc2hvdWxkIGluY2x1ZGUgYSBrZXk/IE90aGVyd2lzZSB5b3VyIGhhbmRsZXIgd2lsbCBoYXZlIGEgdG91Z2ggdGltZSBrbm93aW5nIHdoaWNoIHNpZ25hbCBpdCdzIHJlc3BvbmRpbmcgdG8uXHJcbiAgICBjcmVhdGUgKCkge1xyXG5cclxuICAgICAgICBsZXQgc2lnbmFsID0gbmV3IFNpZ25hbCgpO1xyXG5cclxuICAgICAgICB0aGlzLnNpZ25hbHMuYWRkKHNpZ25hbCk7XHJcblxyXG4gICAgICAgIHJldHVybiBzaWduYWw7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZSAoc2lnbmFsKSB7XHJcblxyXG4gICAgICAgIHRoaXMuc2lnbmFscy5kZWxldGUoc2lnbmFsKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQWxsICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5zaWduYWxzLmNsZWFyKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGxpc3RlbiAobGlzdGVuZXIpIHtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgc2lnbmFsIG9mIHRoaXMuc2lnbmFscylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHNpZ25hbC5hZGQobGlzdGVuZXIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG59XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvc3lzdGVtL1NpZ25hbEdyb3VwLmpzXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==