!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("dom",[],t):"object"==typeof exports?exports.dom=t():(e.lazer=e.lazer||{},e.lazer.dom=t())}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}({0:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.RequestAnimationFrame=t.RemoveFromDOM=t.RemoveEventListener=t.Boot=t.AddToDOM=t.AddEventListener=void 0;var i=n(151),r=o(i),u=n(152),a=o(u),s=n(153),d=o(s),c=n(154),f=o(c),l=n(155),m=o(l),v=n(156),h=o(v);t.AddEventListener=r["default"],t.AddToDOM=a["default"],t.Boot=d["default"],t.RemoveEventListener=f["default"],t.RemoveFromDOM=m["default"],t.RequestAnimationFrame=h["default"]},151:function(e,t){"use strict";function n(e,t,n){var o=arguments.length<=3||void 0===arguments[3]?!1:arguments[3];e.addEventListener(t,n,o)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},152:function(e,t){"use strict";function n(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],n=arguments.length<=2||void 0===arguments[2]?!0:arguments[2],i=void 0;return t&&("string"==typeof t?i=document.getElementById(t):"object"===("undefined"==typeof t?"undefined":o(t))&&1===t.nodeType&&(i=t)),i||(i=document.body),n&&i.style&&(i.style.overflow="hidden"),i.appendChild(e),e}Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t["default"]=n},153:function(e,t){"use strict";function n(){return o?void 0:new Promise(function(e,t){"complete"===document.readyState||"interactive"===document.readyState?(o=!0,e()):!function(){var t=function n(){document.removeEventListener("deviceready",n,!0),document.removeEventListener("DOMContentLoaded",n,!0),window.removeEventListener("load",n,!0),e()};document.body?(document.addEventListener("DOMContentLoaded",t,!0),window.addEventListener("load",t,!0)):window.setTimeout(t,20)}()})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var o=!1},154:function(e,t){"use strict";function n(e,t,n){e.removeEventListener(t,n)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},155:function(e,t){"use strict";function n(e){e.parentNode&&e.parentNode.removeChild(e)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},156:function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(157),a=o(u),s=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];i(this,e),this.root=t,this.forceSetTimeOut=n,n||(this.forceSetTimeOut=!this.normalizeRaf()),this._running=!1,this._timeOutID=null,this._callback=a["default"]}return r(e,[{key:"start",value:function(e){var t=this;this._running||(this._running=!0,this._callback=e,this.usingSetTimeout?this._timeOutID=this.root.setTimeout(function(e){return t.updateSetTimeout(Date.now())},0):this._timeOutID=this.root.requestAnimationFrame(function(e){return t.updateRAF(e)}))}},{key:"updateRAF",value:function(e){var t=this;this._callback(e),this._timeOutID=this.root.requestAnimationFrame(function(e){return t.updateRAF(e)})}},{key:"updateSetTimeout",value:function(e){var t=this;this._timeOutID=this.root.setTimeout(function(e){return t.updateSetTimeout(Date.now())},0)}},{key:"stop",value:function(){this._running&&(this.usingSetTimeout?this.root.clearTimeout(this._timeOutID):this.root.cancelAnimationFrame(this._timeOutID),this._running=!1)}},{key:"normalizeRaf",value:function(){if(this.root.requestAnimationFrame)return!0;for(var e=["ms","moz","webkit","o"],t=0;t<e.length;t++){var n=e[t];return this.root.requestAnimationFrame=this.root[n]+"RequestAnimationFrame",this.root.cancelAnimationFrame=this.root[n]+"CancelAnimationFrame",!0}return!1}},{key:"usingSetTimeout",get:function(){return this.forceSetTimeOut}},{key:"usingRAF",get:function(){return!this.forceSetTimeOut}},{key:"isRunning",get:function(){return this._running},set:function(e){e?this.start():this.stop()}}]),e}();t["default"]=s},157:function(e,t){"use strict";function n(){}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n}})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uPzVjYTYqKioqKioiLCJ3ZWJwYWNrOi8vL2RvbS5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgMWI2ZjU4YTE3NzQ1MDgwZjAwMWE/Nzc5ZSoqKioqKiIsIndlYnBhY2s6Ly8vLi9zcmMvZG9tL2luZGV4LmpzIiwid2VicGFjazovLy8uL3NyYy9kb20vQWRkRXZlbnRMaXN0ZW5lci5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZG9tL0FkZFRvRE9NLmpzIiwid2VicGFjazovLy8uL3NyYy9kb20vQm9vdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvZG9tL1JlbW92ZUV2ZW50TGlzdGVuZXIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2RvbS9SZW1vdmVGcm9tRE9NLmpzIiwid2VicGFjazovLy8uL3NyYy9kb20vUmVxdWVzdEFuaW1hdGlvbkZyYW1lLmpzIiwid2VicGFjazovLy8uL3NyYy9zeXN0ZW0vTk9PUC5qcyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJ0aGlzIiwibW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJpZCIsImxvYWRlZCIsImNhbGwiLCJtIiwiYyIsInAiLCIwIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ2YWx1ZSIsIlJlcXVlc3RBbmltYXRpb25GcmFtZSIsIlJlbW92ZUZyb21ET00iLCJSZW1vdmVFdmVudExpc3RlbmVyIiwiQm9vdCIsIkFkZFRvRE9NIiwiQWRkRXZlbnRMaXN0ZW5lciIsInVuZGVmaW5lZCIsIl9BZGRFdmVudExpc3RlbmVyIiwiX0FkZEV2ZW50TGlzdGVuZXIyIiwiX0FkZFRvRE9NIiwiX0FkZFRvRE9NMiIsIl9Cb290IiwiX0Jvb3QyIiwiX1JlbW92ZUV2ZW50TGlzdGVuZXIiLCJfUmVtb3ZlRXZlbnRMaXN0ZW5lcjIiLCJfUmVtb3ZlRnJvbURPTSIsIl9SZW1vdmVGcm9tRE9NMiIsIl9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJfUmVxdWVzdEFuaW1hdGlvbkZyYW1lMiIsIjE1MSIsInRhcmdldCIsImV2ZW50IiwibGlzdGVuZXIiLCJ1c2VDYXB0dXJlIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiYWRkRXZlbnRMaXN0ZW5lciIsIjE1MiIsImVsZW1lbnQiLCJwYXJlbnQiLCJvdmVyZmxvd0hpZGRlbiIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJfdHlwZW9mIiwibm9kZVR5cGUiLCJib2R5Iiwic3R5bGUiLCJvdmVyZmxvdyIsImFwcGVuZENoaWxkIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJjb25zdHJ1Y3RvciIsIjE1MyIsImlzQm9vdGVkIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJyZWFkeVN0YXRlIiwiY2hlY2siLCJyZW1vdmVFdmVudExpc3RlbmVyIiwid2luZG93Iiwic2V0VGltZW91dCIsIjE1NCIsIjE1NSIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsIjE1NiIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwicHJvcHMiLCJpIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIl9OT09QIiwiX05PT1AyIiwiZm9yY2VTZXRUaW1lT3V0Iiwibm9ybWFsaXplUmFmIiwiX3J1bm5pbmciLCJfdGltZU91dElEIiwiX2NhbGxiYWNrIiwiY2FsbGJhY2siLCJfdGhpcyIsInVzaW5nU2V0VGltZW91dCIsIm5vdyIsInVwZGF0ZVNldFRpbWVvdXQiLCJEYXRlIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwidXBkYXRlUkFGIiwiX3RoaXMyIiwiX3RoaXMzIiwiY2xlYXJUaW1lb3V0IiwiY2FuY2VsQW5pbWF0aW9uRnJhbWUiLCJfYXJyIiwiX2kiLCJ2ZW5kb3IiLCJnZXQiLCJzZXQiLCJzdGFydCIsInN0b3AiLCIxNTciLCJOT09QIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxFQUFBQyxHQUNBLGdCQUFBQyxVQUFBLGdCQUFBQyxRQUNBQSxPQUFBRCxRQUFBRCxJQUNBLGtCQUFBRyxnQkFBQUMsSUFDQUQsT0FBQSxTQUFBSCxHQUNBLGdCQUFBQyxTQUNBQSxRQUFBLElBQUFELEtBRUFELEVBQUEsTUFBQUEsRUFBQSxVQUFxQ0EsRUFBQSxVQUFBQyxNQUNwQ0ssS0FBQSxXQUNELE1DQWdCLFVBQVVDLEdDTjFCLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBUCxPQUdBLElBQUFDLEdBQUFPLEVBQUFELElBQ0FQLFdBQ0FTLEdBQUFGLEVBQ0FHLFFBQUEsRUFVQSxPQU5BTCxHQUFBRSxHQUFBSSxLQUFBVixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBTSxHQUdBTCxFQUFBUyxRQUFBLEVBR0FULEVBQUFELFFBdkJBLEdBQUFRLEtBcUNBLE9BVEFGLEdBQUFNLEVBQUFQLEVBR0FDLEVBQUFPLEVBQUFMLEVBR0FGLEVBQUFRLEVBQUEsR0FHQVIsRUFBQSxLRGdCTVMsRUFDQSxTQUFTZCxFQUFRRCxFQUFTTSxHQUUvQixZQStCQSxTQUFTVSxHQUF1QkMsR0FBTyxNQUFPQSxJQUFPQSxFQUFJQyxXQUFhRCxHQUFRRSxVQUFTRixHQTdCdkZHLE9BQU9DLGVBQWVyQixFQUFTLGNBQzNCc0IsT0FBTyxJQUVYdEIsRUFBUXVCLHNCQUF3QnZCLEVBQVF3QixjQUFnQnhCLEVBQVF5QixvQkFBc0J6QixFQUFRMEIsS0FBTzFCLEVBQVEyQixTQUFXM0IsRUFBUTRCLGlCQUFtQkMsTUU5RHBKLElBQUFDLEdBQUF4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QixLQUFNLE1BQU8sU0FBVSxLQUEzQ0MsRUFBQSxFQUFBQSxFQUFBRCxFQUFBbkUsT0FBQW9FLElBQ0EsQ0FESyxHQUFJQyxHQUFBRixFQUFBQyxFQU1ELE9BRkFoSCxNQUFLTixLQUFLK0csc0JBQXdCekcsS0FBS04sS0FBS3VILEdBQVUsd0JBQ3REakgsS0FBS04sS0FBS29ILHFCQUF1QjlHLEtBQUtOLEtBQUt1SCxHQUFVLHdCQUM5QyxFQUtuQixPQUFPLEtSMlFOekIsSUFBSyxrQkFDTDBCLElBQUssV1F0UU4sTUFBT2xILE1BQUs4RixtQlIyUVhOLElBQUssV0FDTDBCLElBQUssV1F0UU4sT0FBUWxILEtBQUs4RixtQlIyUVpOLElBQUssWUFDTDBCLElBQUssV1F0UU4sTUFBT2xILE1BQUtnRyxVUjBRWG1CLElBQUssU1F0UUtqRyxHQUVQQSxFQUVBbEIsS0FBS29ILFFBSUxwSCxLQUFLcUgsV1J3UUxsRyxJQUdYdkIsY1FuWW9CdUIsR1J1WWZtRyxJQUNBLFNBQVN6SCxFQUFRRCxHQUV0QixZU3ZZYyxTQUFTMkgsTVR5WXZCdkcsT0FBT0MsZUFBZXJCLEVBQVMsY0FDM0JzQixPQUFPLElBRVh0QixhUzVZdUIySCIsImZpbGUiOiJkb20uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShcImRvbVwiLCBbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJkb21cIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wibGF6ZXJcIl0gPSByb290W1wibGF6ZXJcIl0gfHwge30sIHJvb3RbXCJsYXplclwiXVtcImRvbVwiXSA9IGZhY3RvcnkoKTtcbn0pKHRoaXMsIGZ1bmN0aW9uKCkge1xucmV0dXJuIFxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHdlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvblxuICoqLyIsIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFwiZG9tXCIsIFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcImRvbVwiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJsYXplclwiXSA9IHJvb3RbXCJsYXplclwiXSB8fCB7fSwgcm9vdFtcImxhemVyXCJdW1wiZG9tXCJdID0gZmFjdG9yeSgpO1xufSkodGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge30sXG4vKioqKioqLyBcdFx0XHRpZDogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovICh7XG5cbi8qKiovIDA6XG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLlJlcXVlc3RBbmltYXRpb25GcmFtZSA9IGV4cG9ydHMuUmVtb3ZlRnJvbURPTSA9IGV4cG9ydHMuUmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGV4cG9ydHMuQm9vdCA9IGV4cG9ydHMuQWRkVG9ET00gPSBleHBvcnRzLkFkZEV2ZW50TGlzdGVuZXIgPSB1bmRlZmluZWQ7XG5cdFxuXHR2YXIgX0FkZEV2ZW50TGlzdGVuZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1MSk7XG5cdFxuXHR2YXIgX0FkZEV2ZW50TGlzdGVuZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfQWRkRXZlbnRMaXN0ZW5lcik7XG5cdFxuXHR2YXIgX0FkZFRvRE9NID0gX193ZWJwYWNrX3JlcXVpcmVfXygxNTIpO1xuXHRcblx0dmFyIF9BZGRUb0RPTTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9BZGRUb0RPTSk7XG5cdFxuXHR2YXIgX0Jvb3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1Myk7XG5cdFxuXHR2YXIgX0Jvb3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfQm9vdCk7XG5cdFxuXHR2YXIgX1JlbW92ZUV2ZW50TGlzdGVuZXIgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1NCk7XG5cdFxuXHR2YXIgX1JlbW92ZUV2ZW50TGlzdGVuZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUmVtb3ZlRXZlbnRMaXN0ZW5lcik7XG5cdFxuXHR2YXIgX1JlbW92ZUZyb21ET00gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1NSk7XG5cdFxuXHR2YXIgX1JlbW92ZUZyb21ET00yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfUmVtb3ZlRnJvbURPTSk7XG5cdFxuXHR2YXIgX1JlcXVlc3RBbmltYXRpb25GcmFtZSA9IF9fd2VicGFja19yZXF1aXJlX18oMTU2KTtcblx0XG5cdHZhciBfUmVxdWVzdEFuaW1hdGlvbkZyYW1lMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1JlcXVlc3RBbmltYXRpb25GcmFtZSk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0ZXhwb3J0cy5BZGRFdmVudExpc3RlbmVyID0gX0FkZEV2ZW50TGlzdGVuZXIyLmRlZmF1bHQ7XG5cdGV4cG9ydHMuQWRkVG9ET00gPSBfQWRkVG9ET00yLmRlZmF1bHQ7XG5cdGV4cG9ydHMuQm9vdCA9IF9Cb290Mi5kZWZhdWx0O1xuXHRleHBvcnRzLlJlbW92ZUV2ZW50TGlzdGVuZXIgPSBfUmVtb3ZlRXZlbnRMaXN0ZW5lcjIuZGVmYXVsdDtcblx0ZXhwb3J0cy5SZW1vdmVGcm9tRE9NID0gX1JlbW92ZUZyb21ET00yLmRlZmF1bHQ7XG5cdGV4cG9ydHMuUmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gX1JlcXVlc3RBbmltYXRpb25GcmFtZTIuZGVmYXVsdDtcblxuLyoqKi8gfSxcblxuLyoqKi8gMTUxOlxuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLmRlZmF1bHQgPSBBZGRFdmVudExpc3RlbmVyO1xuXHRmdW5jdGlvbiBBZGRFdmVudExpc3RlbmVyKHRhcmdldCwgZXZlbnQsIGxpc3RlbmVyKSB7XG5cdCAgICB2YXIgdXNlQ2FwdHVyZSA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMyB8fCBhcmd1bWVudHNbM10gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogYXJndW1lbnRzWzNdO1xuXHRcblx0XG5cdCAgICB0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIsIHVzZUNhcHR1cmUpO1xuXHR9XG5cbi8qKiovIH0sXG5cbi8qKiovIDE1Mjpcbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdFxuXHR2YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblx0XG5cdGV4cG9ydHMuZGVmYXVsdCA9IEFkZFRvRE9NO1xuXHRmdW5jdGlvbiBBZGRUb0RPTShlbGVtZW50KSB7XG5cdCAgICB2YXIgcGFyZW50ID0gYXJndW1lbnRzLmxlbmd0aCA8PSAxIHx8IGFyZ3VtZW50c1sxXSA9PT0gdW5kZWZpbmVkID8gbnVsbCA6IGFyZ3VtZW50c1sxXTtcblx0ICAgIHZhciBvdmVyZmxvd0hpZGRlbiA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMiB8fCBhcmd1bWVudHNbMl0gPT09IHVuZGVmaW5lZCA/IHRydWUgOiBhcmd1bWVudHNbMl07XG5cdFxuXHRcblx0ICAgIHZhciB0YXJnZXQgPSB2b2lkIDA7XG5cdFxuXHQgICAgaWYgKHBhcmVudCkge1xuXHQgICAgICAgIGlmICh0eXBlb2YgcGFyZW50ID09PSAnc3RyaW5nJykge1xuXHQgICAgICAgICAgICAvLyBob3BlZnVsbHkgYW4gZWxlbWVudCBJRFxuXHQgICAgICAgICAgICB0YXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwYXJlbnQpO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoKHR5cGVvZiBwYXJlbnQgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKHBhcmVudCkpID09PSAnb2JqZWN0JyAmJiBwYXJlbnQubm9kZVR5cGUgPT09IDEpIHtcblx0ICAgICAgICAgICAgLy8gcXVpY2sgdGVzdCBmb3IgYSBIVE1MZWxlbWVudFxuXHQgICAgICAgICAgICB0YXJnZXQgPSBwYXJlbnQ7XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXHRcblx0ICAgIC8vIEZhbGxiYWNrLCBjb3ZlcnMgYW4gaW52YWxpZCBJRCBhbmQgYSBub24gSFRNTGVsZW1lbnQgb2JqZWN0XG5cdCAgICBpZiAoIXRhcmdldCkge1xuXHQgICAgICAgIHRhcmdldCA9IGRvY3VtZW50LmJvZHk7XG5cdCAgICB9XG5cdFxuXHQgICAgaWYgKG92ZXJmbG93SGlkZGVuICYmIHRhcmdldC5zdHlsZSkge1xuXHQgICAgICAgIHRhcmdldC5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nO1xuXHQgICAgfVxuXHRcblx0ICAgIHRhcmdldC5hcHBlbmRDaGlsZChlbGVtZW50KTtcblx0XG5cdCAgICByZXR1cm4gZWxlbWVudDtcblx0fVxuXG4vKioqLyB9LFxuXG4vKioqLyAxNTM6XG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLmRlZmF1bHQgPSBCb290O1xuXHR2YXIgaXNCb290ZWQgPSBmYWxzZTtcblx0XG5cdGZ1bmN0aW9uIEJvb3QoKSB7XG5cdFxuXHQgICAgaWYgKGlzQm9vdGVkKSB7XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXHRcblx0ICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdCAgICAgICAgaWYgKGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScgfHwgZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2ludGVyYWN0aXZlJykge1xuXHQgICAgICAgICAgICBpc0Jvb3RlZCA9IHRydWU7XG5cdFxuXHQgICAgICAgICAgICByZXNvbHZlKCk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICAgIHZhciBjaGVjayA9IGZ1bmN0aW9uIGNoZWNrKCkge1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdkZXZpY2VyZWFkeScsIGNoZWNrLCB0cnVlKTtcblx0ICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgY2hlY2ssIHRydWUpO1xuXHQgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdsb2FkJywgY2hlY2ssIHRydWUpO1xuXHRcblx0ICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XG5cdCAgICAgICAgICAgICAgICB9O1xuXHRcblx0ICAgICAgICAgICAgICAgIGlmICghZG9jdW1lbnQuYm9keSkge1xuXHQgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGNoZWNrLCAyMCk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBjaGVjaywgdHJ1ZSk7XG5cdCAgICAgICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBjaGVjaywgdHJ1ZSk7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pKCk7XG5cdCAgICAgICAgfVxuXHQgICAgfSk7XG5cdH1cblxuLyoqKi8gfSxcblxuLyoqKi8gMTU0OlxuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcblx0ICAgIHZhbHVlOiB0cnVlXG5cdH0pO1xuXHRleHBvcnRzLmRlZmF1bHQgPSBSZW1vdmVFdmVudExpc3RlbmVyO1xuXHRmdW5jdGlvbiBSZW1vdmVFdmVudExpc3RlbmVyKHRhcmdldCwgZXZlbnQsIGxpc3RlbmVyKSB7XG5cdFxuXHQgICAgdGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTtcblx0fVxuXG4vKioqLyB9LFxuXG4vKioqLyAxNTU6XG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdGV4cG9ydHMuZGVmYXVsdCA9IFJlbW92ZUZyb21ET007XG5cdGZ1bmN0aW9uIFJlbW92ZUZyb21ET00oZWxlbWVudCkge1xuXHRcblx0ICAgIGlmIChlbGVtZW50LnBhcmVudE5vZGUpIHtcblx0ICAgICAgICBlbGVtZW50LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWxlbWVudCk7XG5cdCAgICB9XG5cdH1cblxuLyoqKi8gfSxcblxuLyoqKi8gMTU2OlxuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG5cdCAgICB2YWx1ZTogdHJ1ZVxuXHR9KTtcblx0XG5cdHZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cdFxuXHR2YXIgX05PT1AgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDE1Nyk7XG5cdFxuXHR2YXIgX05PT1AyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfTk9PUCk7XG5cdFxuXHRmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXHRcblx0ZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblx0XG5cdHZhciBSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICBmdW5jdGlvbiBSZXF1ZXN0QW5pbWF0aW9uRnJhbWUocm9vdCkge1xuXHQgICAgICAgIHZhciBmb3JjZVNldFRpbWVPdXQgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IGFyZ3VtZW50c1sxXTtcblx0XG5cdCAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJlcXVlc3RBbmltYXRpb25GcmFtZSk7XG5cdFxuXHQgICAgICAgIHRoaXMucm9vdCA9IHJvb3Q7XG5cdCAgICAgICAgdGhpcy5mb3JjZVNldFRpbWVPdXQgPSBmb3JjZVNldFRpbWVPdXQ7XG5cdFxuXHQgICAgICAgIC8vICBJZiB0aGVyZSdzIG5vIHdpbmRvdyBvYmplY3Qgb3IgUkFGIHRoZW4gd2UgaGF2ZSB0byB1c2UgU1QgYW55d2F5XG5cdCAgICAgICAgaWYgKCFmb3JjZVNldFRpbWVPdXQpIHtcblx0ICAgICAgICAgICAgdGhpcy5mb3JjZVNldFRpbWVPdXQgPSAhdGhpcy5ub3JtYWxpemVSYWYoKTtcblx0ICAgICAgICB9XG5cdFxuXHQgICAgICAgIHRoaXMuX3J1bm5pbmcgPSBmYWxzZTtcblx0ICAgICAgICB0aGlzLl90aW1lT3V0SUQgPSBudWxsO1xuXHQgICAgICAgIHRoaXMuX2NhbGxiYWNrID0gX05PT1AyLmRlZmF1bHQ7XG5cdCAgICB9XG5cdFxuXHQgICAgLy8gIFVuZGVyIFNldFRpbWVvdXQgdGhlIGNhbGxiYWNrIG11c3QgcmV0dXJuIHRoZSBtcyB2YWx1ZSBvZiB3aGVuIHRvIHJ1biB0aGUgbmV4dCB1cGRhdGVcblx0XG5cdFxuXHQgICAgX2NyZWF0ZUNsYXNzKFJlcXVlc3RBbmltYXRpb25GcmFtZSwgW3tcblx0ICAgICAgICBrZXk6ICdzdGFydCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0YXJ0KGNhbGxiYWNrKSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICBpZiAoIXRoaXMuX3J1bm5pbmcpIHtcblx0ICAgICAgICAgICAgICAgIHRoaXMuX3J1bm5pbmcgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBjYWxsYmFjaztcblx0XG5cdCAgICAgICAgICAgICAgICBpZiAodGhpcy51c2luZ1NldFRpbWVvdXQpIHtcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLl90aW1lT3V0SUQgPSB0aGlzLnJvb3Quc2V0VGltZW91dChmdW5jdGlvbiAobm93KSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy51cGRhdGVTZXRUaW1lb3V0KERhdGUubm93KCkpO1xuXHQgICAgICAgICAgICAgICAgICAgIH0sIDApO1xuXHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLl90aW1lT3V0SUQgPSB0aGlzLnJvb3QucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uIChub3cpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnVwZGF0ZVJBRihub3cpO1xuXHQgICAgICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgfSwge1xuXHQgICAgICAgIGtleTogJ3VwZGF0ZVJBRicsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZVJBRihub3cpIHtcblx0ICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cdFxuXHQgICAgICAgICAgICB0aGlzLl9jYWxsYmFjayhub3cpO1xuXHRcblx0ICAgICAgICAgICAgdGhpcy5fdGltZU91dElEID0gdGhpcy5yb290LnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiAobm93KSB7XG5cdCAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLnVwZGF0ZVJBRihub3cpO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAndXBkYXRlU2V0VGltZW91dCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZVNldFRpbWVvdXQobm93KSB7XG5cdCAgICAgICAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXHRcblx0ICAgICAgICAgICAgdGhpcy5fdGltZU91dElEID0gdGhpcy5yb290LnNldFRpbWVvdXQoZnVuY3Rpb24gKG5vdykge1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMy51cGRhdGVTZXRUaW1lb3V0KERhdGUubm93KCkpO1xuXHQgICAgICAgICAgICB9LCAwKTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnc3RvcCcsXG5cdCAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0b3AoKSB7XG5cdFxuXHQgICAgICAgICAgICBpZiAodGhpcy5fcnVubmluZykge1xuXHQgICAgICAgICAgICAgICAgaWYgKHRoaXMudXNpbmdTZXRUaW1lb3V0KSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290LmNsZWFyVGltZW91dCh0aGlzLl90aW1lT3V0SUQpO1xuXHQgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICB0aGlzLnJvb3QuY2FuY2VsQW5pbWF0aW9uRnJhbWUodGhpcy5fdGltZU91dElEKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgICAgICB0aGlzLl9ydW5uaW5nID0gZmFsc2U7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnbm9ybWFsaXplUmFmJyxcblx0ICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbm9ybWFsaXplUmFmKCkge1xuXHRcblx0ICAgICAgICAgICAgaWYgKHRoaXMucm9vdC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUpIHtcblx0ICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgdmFyIF9hcnIgPSBbJ21zJywgJ21veicsICd3ZWJraXQnLCAnbyddO1xuXHRcblx0ICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBfYXJyLmxlbmd0aDsgX2krKykge1xuXHQgICAgICAgICAgICAgICAgICAgIHZhciB2ZW5kb3IgPSBfYXJyW19pXTtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAodHJ1ZSkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJvb3QucmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gdGhpcy5yb290W3ZlbmRvcl0gKyAnUmVxdWVzdEFuaW1hdGlvbkZyYW1lJztcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290LmNhbmNlbEFuaW1hdGlvbkZyYW1lID0gdGhpcy5yb290W3ZlbmRvcl0gKyAnQ2FuY2VsQW5pbWF0aW9uRnJhbWUnO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0XG5cdCAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAndXNpbmdTZXRUaW1lb3V0Jyxcblx0ICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzLmZvcmNlU2V0VGltZU91dDtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAndXNpbmdSQUYnLFxuXHQgICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuXHRcblx0ICAgICAgICAgICAgcmV0dXJuICF0aGlzLmZvcmNlU2V0VGltZU91dDtcblx0ICAgICAgICB9XG5cdCAgICB9LCB7XG5cdCAgICAgICAga2V5OiAnaXNSdW5uaW5nJyxcblx0ICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcblx0XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzLl9ydW5uaW5nO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcblx0XG5cdCAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuXHQgICAgICAgICAgICAgICAgdGhpcy5zdGFydCgpO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgdGhpcy5zdG9wKCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICB9XSk7XG5cdFxuXHQgICAgcmV0dXJuIFJlcXVlc3RBbmltYXRpb25GcmFtZTtcblx0fSgpO1xuXHRcblx0ZXhwb3J0cy5kZWZhdWx0ID0gUmVxdWVzdEFuaW1hdGlvbkZyYW1lO1xuXG4vKioqLyB9LFxuXG4vKioqLyAxNTc6XG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuXHQgICAgdmFsdWU6IHRydWVcblx0fSk7XG5cdGV4cG9ydHMuZGVmYXVsdCA9IE5PT1A7XG5cdC8vIEluIGFsbCBtYWpvciBicm93c2VycywgcmVwbGFjaW5nIG5vbi1zcGVjaWZpZWQgZnVuY3Rpb25zIHdpdGggTk9PUHNcblx0Ly8gc2VlbXMgdG8gYmUgYXMgZmFzdCBvciBzbGlnaHRseSBmYXN0ZXIgdGhhbiB1c2luZyBjb25kaXRpb25zIHRvIG9ubHlcblx0Ly8gY2FsbCB0aGUgZnVuY3Rpb25zIGlmIHRoZXkgYXJlIHNwZWNpZmllZC4gVGhpcyBpcyBwcm9iYWJseSBkdWUgdG8gZW1wdHlcblx0Ly8gZnVuY3Rpb25zIGJlaW5nIG9wdGltaXplZCBhd2F5LiBodHRwOi8vanNwZXJmLmNvbS9ub29wLXZzLWNvbmRpdGlvblxuXHRcblx0ZnVuY3Rpb24gTk9PUCgpIHtcblx0XG5cdCAgICAvLyAgVGhhdCdzIHJpZ2h0LCB0aGVyZSdzIG5vdGhpbmcgaGVyZS5cblx0XG5cdH1cblxuLyoqKi8gfVxuXG4vKioqKioqLyB9KVxufSk7XG47XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogZG9tLmpzXG4gKiovIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGV4cG9ydHM6IHt9LFxuIFx0XHRcdGlkOiBtb2R1bGVJZCxcbiBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiB3ZWJwYWNrL2Jvb3RzdHJhcCAxYjZmNThhMTc3NDUwODBmMDAxYVxuICoqLyIsImltcG9ydCBBZGRFdmVudExpc3RlbmVyIGZyb20gJy4vQWRkRXZlbnRMaXN0ZW5lci5qcyc7XHJcbmltcG9ydCBBZGRUb0RPTSBmcm9tICcuL0FkZFRvRE9NLmpzJztcclxuaW1wb3J0IEJvb3QgZnJvbSAnLi9Cb290LmpzJztcclxuaW1wb3J0IFJlbW92ZUV2ZW50TGlzdGVuZXIgZnJvbSAnLi9SZW1vdmVFdmVudExpc3RlbmVyLmpzJztcclxuaW1wb3J0IFJlbW92ZUZyb21ET00gZnJvbSAnLi9SZW1vdmVGcm9tRE9NLmpzJztcclxuaW1wb3J0IFJlcXVlc3RBbmltYXRpb25GcmFtZSBmcm9tICcuL1JlcXVlc3RBbmltYXRpb25GcmFtZS5qcyc7XHJcblxyXG5leHBvcnQge1xyXG4gICAgQWRkRXZlbnRMaXN0ZW5lcixcclxuICAgIEFkZFRvRE9NLFxyXG4gICAgQm9vdCxcclxuICAgIFJlbW92ZUV2ZW50TGlzdGVuZXIsXHJcbiAgICBSZW1vdmVGcm9tRE9NLFxyXG4gICAgUmVxdWVzdEFuaW1hdGlvbkZyYW1lXHJcbn07XHJcblxyXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9kb20vaW5kZXguanNcbiAqKi8iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBBZGRFdmVudExpc3RlbmVyICh0YXJnZXQsIGV2ZW50LCBsaXN0ZW5lciwgdXNlQ2FwdHVyZSA9IGZhbHNlKSB7XHJcblxyXG4gICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyLCB1c2VDYXB0dXJlKTtcclxuICAgIFxyXG59XHJcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2RvbS9BZGRFdmVudExpc3RlbmVyLmpzXG4gKiovIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQWRkVG9ET00gKGVsZW1lbnQsIHBhcmVudCA9IG51bGwsIG92ZXJmbG93SGlkZGVuID0gdHJ1ZSkge1xyXG5cclxuICAgIGxldCB0YXJnZXQ7XHJcblxyXG4gICAgaWYgKHBhcmVudClcclxuICAgIHtcclxuICAgICAgICBpZiAodHlwZW9mIHBhcmVudCA9PT0gJ3N0cmluZycpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAvLyBob3BlZnVsbHkgYW4gZWxlbWVudCBJRFxyXG4gICAgICAgICAgICB0YXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwYXJlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgcGFyZW50ID09PSAnb2JqZWN0JyAmJiBwYXJlbnQubm9kZVR5cGUgPT09IDEpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICAvLyBxdWljayB0ZXN0IGZvciBhIEhUTUxlbGVtZW50XHJcbiAgICAgICAgICAgIHRhcmdldCA9IHBhcmVudDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRmFsbGJhY2ssIGNvdmVycyBhbiBpbnZhbGlkIElEIGFuZCBhIG5vbiBIVE1MZWxlbWVudCBvYmplY3RcclxuICAgIGlmICghdGFyZ2V0KVxyXG4gICAge1xyXG4gICAgICAgIHRhcmdldCA9IGRvY3VtZW50LmJvZHk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKG92ZXJmbG93SGlkZGVuICYmIHRhcmdldC5zdHlsZSlcclxuICAgIHtcclxuICAgICAgICB0YXJnZXQuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJztcclxuICAgIH1cclxuXHJcbiAgICB0YXJnZXQuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XHJcblxyXG4gICAgcmV0dXJuIGVsZW1lbnQ7XHJcblxyXG59XHJcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2RvbS9BZGRUb0RPTS5qc1xuICoqLyIsImxldCBpc0Jvb3RlZCA9IGZhbHNlO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQm9vdCAoKSB7XHJcblxyXG4gICAgaWYgKGlzQm9vdGVkKVxyXG4gICAge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoXHJcbiAgICAgICAgKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gJ2NvbXBsZXRlJyB8fCBkb2N1bWVudC5yZWFkeVN0YXRlID09PSAnaW50ZXJhY3RpdmUnKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpc0Jvb3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrICgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignZGV2aWNlcmVhZHknLCBjaGVjaywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGNoZWNrLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbG9hZCcsIGNoZWNrLCB0cnVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICghZG9jdW1lbnQuYm9keSlcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChjaGVjaywgMjApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBjaGVjaywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBjaGVjaywgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICApO1xyXG4gICAgXHJcbn1cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9kb20vQm9vdC5qc1xuICoqLyIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIFJlbW92ZUV2ZW50TGlzdGVuZXIgKHRhcmdldCwgZXZlbnQsIGxpc3RlbmVyKSB7XHJcblxyXG4gICAgdGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTtcclxuICAgIFxyXG59XHJcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL2RvbS9SZW1vdmVFdmVudExpc3RlbmVyLmpzXG4gKiovIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gUmVtb3ZlRnJvbURPTSAoZWxlbWVudCkge1xyXG5cclxuICAgIGlmIChlbGVtZW50LnBhcmVudE5vZGUpXHJcbiAgICB7XHJcbiAgICAgICAgZWxlbWVudC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxufVxyXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9kb20vUmVtb3ZlRnJvbURPTS5qc1xuICoqLyIsImltcG9ydCBOT09QIGZyb20gJy4uL3N5c3RlbS9OT09QLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlcXVlc3RBbmltYXRpb25GcmFtZSB7XHJcblxyXG4gICAgY29uc3RydWN0b3IgKHJvb3QsIGZvcmNlU2V0VGltZU91dCA9IGZhbHNlKSB7XHJcblxyXG4gICAgICAgIHRoaXMucm9vdCA9IHJvb3Q7XHJcbiAgICAgICAgdGhpcy5mb3JjZVNldFRpbWVPdXQgPSBmb3JjZVNldFRpbWVPdXQ7XHJcblxyXG4gICAgICAgIC8vICBJZiB0aGVyZSdzIG5vIHdpbmRvdyBvYmplY3Qgb3IgUkFGIHRoZW4gd2UgaGF2ZSB0byB1c2UgU1QgYW55d2F5XHJcbiAgICAgICAgaWYgKCFmb3JjZVNldFRpbWVPdXQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLmZvcmNlU2V0VGltZU91dCA9ICF0aGlzLm5vcm1hbGl6ZVJhZigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fcnVubmluZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX3RpbWVPdXRJRCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBOT09QO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICAvLyAgVW5kZXIgU2V0VGltZW91dCB0aGUgY2FsbGJhY2sgbXVzdCByZXR1cm4gdGhlIG1zIHZhbHVlIG9mIHdoZW4gdG8gcnVuIHRoZSBuZXh0IHVwZGF0ZVxyXG4gICAgc3RhcnQgKGNhbGxiYWNrKSB7XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5fcnVubmluZylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRoaXMuX3J1bm5pbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9jYWxsYmFjayA9IGNhbGxiYWNrO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoaXMudXNpbmdTZXRUaW1lb3V0KVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90aW1lT3V0SUQgPSB0aGlzLnJvb3Quc2V0VGltZW91dChub3cgPT4gdGhpcy51cGRhdGVTZXRUaW1lb3V0KERhdGUubm93KCkpLCAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3RpbWVPdXRJRCA9IHRoaXMucm9vdC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUobm93ID0+IHRoaXMudXBkYXRlUkFGKG5vdykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVSQUYgKG5vdykge1xyXG5cclxuICAgICAgICB0aGlzLl9jYWxsYmFjayhub3cpO1xyXG5cclxuICAgICAgICB0aGlzLl90aW1lT3V0SUQgPSB0aGlzLnJvb3QucmVxdWVzdEFuaW1hdGlvbkZyYW1lKG5vdyA9PiB0aGlzLnVwZGF0ZVJBRihub3cpKTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlU2V0VGltZW91dCAobm93KSB7XHJcblxyXG4gICAgICAgIHRoaXMuX3RpbWVPdXRJRCA9IHRoaXMucm9vdC5zZXRUaW1lb3V0KG5vdyA9PiB0aGlzLnVwZGF0ZVNldFRpbWVvdXQoRGF0ZS5ub3coKSksIDApO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzdG9wICgpIHtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX3J1bm5pbmcpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBpZiAodGhpcy51c2luZ1NldFRpbWVvdXQpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucm9vdC5jbGVhclRpbWVvdXQodGhpcy5fdGltZU91dElEKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucm9vdC5jYW5jZWxBbmltYXRpb25GcmFtZSh0aGlzLl90aW1lT3V0SUQpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9ydW5uaW5nID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBub3JtYWxpemVSYWYgKCkge1xyXG5cclxuICAgICAgICBpZiAodGhpcy5yb290LnJlcXVlc3RBbmltYXRpb25GcmFtZSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBmb3IgKGxldCB2ZW5kb3Igb2YgWydtcycsICdtb3onLCAnd2Via2l0JywgJ28nXSlcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucm9vdFt2ZW5kb3JdICsgJ1JlcXVlc3RBbmltYXRpb25GcmFtZScpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290LnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IHRoaXMucm9vdFt2ZW5kb3JdICsgJ1JlcXVlc3RBbmltYXRpb25GcmFtZSc7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yb290LmNhbmNlbEFuaW1hdGlvbkZyYW1lID0gdGhpcy5yb290W3ZlbmRvcl0gKyAnQ2FuY2VsQW5pbWF0aW9uRnJhbWUnO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldCB1c2luZ1NldFRpbWVvdXQgKCkge1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5mb3JjZVNldFRpbWVPdXQ7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldCB1c2luZ1JBRiAoKSB7XHJcblxyXG4gICAgICAgIHJldHVybiAhdGhpcy5mb3JjZVNldFRpbWVPdXQ7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGdldCBpc1J1bm5pbmcgKCkge1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5fcnVubmluZztcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGlzUnVubmluZyAodmFsdWUpIHtcclxuXHJcbiAgICAgICAgaWYgKHZhbHVlKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5zdGFydCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxufVxyXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9kb20vUmVxdWVzdEFuaW1hdGlvbkZyYW1lLmpzXG4gKiovIiwiLy8gSW4gYWxsIG1ham9yIGJyb3dzZXJzLCByZXBsYWNpbmcgbm9uLXNwZWNpZmllZCBmdW5jdGlvbnMgd2l0aCBOT09Qc1xyXG4vLyBzZWVtcyB0byBiZSBhcyBmYXN0IG9yIHNsaWdodGx5IGZhc3RlciB0aGFuIHVzaW5nIGNvbmRpdGlvbnMgdG8gb25seVxyXG4vLyBjYWxsIHRoZSBmdW5jdGlvbnMgaWYgdGhleSBhcmUgc3BlY2lmaWVkLiBUaGlzIGlzIHByb2JhYmx5IGR1ZSB0byBlbXB0eVxyXG4vLyBmdW5jdGlvbnMgYmVpbmcgb3B0aW1pemVkIGF3YXkuIGh0dHA6Ly9qc3BlcmYuY29tL25vb3AtdnMtY29uZGl0aW9uXHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBOT09QICgpIHtcclxuXHJcbiAgICAvLyAgVGhhdCdzIHJpZ2h0LCB0aGVyZSdzIG5vdGhpbmcgaGVyZS5cclxuICAgIFxyXG59XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvc3lzdGVtL05PT1AuanNcbiAqKi8iXSwic291cmNlUm9vdCI6IiJ9